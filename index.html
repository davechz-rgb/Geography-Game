<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Geography Trainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;font-family:system-ui;
  background:linear-gradient(180deg,#0b1220,#0e1a33);
  color:#fff
}
#app{max-width:520px;margin:auto;padding:14px}
.hidden{display:none}
button{cursor:pointer}

.topbar{
  position:sticky;top:0;
  background:rgba(255,255,255,.1);
  backdrop-filter:blur(12px);
  padding:12px;border-radius:18px;
}
.stats{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.stat{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.15);font-size:12px;font-weight:800}
.progress{height:10px;background:rgba(255,255,255,.15);border-radius:999px;overflow:hidden;margin-top:8px}
.progress div{height:100%;background:linear-gradient(90deg,#67e8f9,#a78bfa);width:0%}

.panel{
  margin-top:14px;padding:16px;border-radius:18px;
  background:rgba(255,255,255,.1)
}
.title{font-size:18px;font-weight:900}
.grid{display:grid;gap:10px;margin-top:12px}
.card{
  padding:14px;border-radius:14px;
  background:rgba(255,255,255,.15);
  font-weight:900
}

.option{
  padding:14px;border-radius:14px;
  background:rgba(255,255,255,.15);
  margin-bottom:8px;font-weight:900
}
.correct{background:rgba(34,197,94,.6)}
.wrong{background:rgba(239,68,68,.6)}
.flag{font-size:64px;text-align:center}
.feedback{margin-top:8px;font-weight:900}

.primary{
  width:100%;padding:14px;border-radius:14px;
  border:none;font-weight:900;
  background:linear-gradient(90deg,#67e8f9,#a78bfa)
}
</style>
</head>

<body>
<div id="app">

<div class="topbar">
  <b>üåç Geography Trainer</b>
  <div class="stats">
    <div class="stat">‚ù§Ô∏è <span id="lives">3</span></div>
    <div class="stat">‚è±Ô∏è <span id="time">--</span></div>
    <div class="stat">üèÜ <span id="score">0</span></div>
  </div>
  <div class="progress"><div id="bar"></div></div>
</div>

<!-- MENU -->
<div id="menu" class="panel">
  <div class="title">Choose Mode</div>
  <div class="grid">
    <div class="card" onclick="startClassic()">Classic</div>
    <div class="card" onclick="startCountdown()">Countdown</div>
    <div class="card" onclick="startFlags()">Flags</div>
    <div class="card" onclick="showTestMenu()">TEST MODE</div>
  </div>
</div>

<!-- TEST MENU -->
<div id="testMenu" class="panel hidden">
  <div class="title">Test Mode ‚Äì Questions</div>
  <div class="grid">
    <div class="card" onclick="startTest(10)">10 Questions</div>
    <div class="card" onclick="startTest(20)">20 Questions</div>
    <div class="card" onclick="startTest(30)">30 Questions</div>
    <div class="card" onclick="startTest(50)">50 Questions</div>
  </div>
</div>

<!-- GAME -->
<div id="game" class="panel hidden">
  <div id="flagBox" class="flag hidden"></div>
  <div id="question" class="title"></div>
  <div id="options"></div>
  <div id="feedback" class="feedback hidden"></div>
  <button id="nextBtn" class="primary hidden">Next</button>
</div>

<script>
const DATA=[
  {c:"Costa Rica",cap:"San Jos√©",lang:"Spanish",dem:"Costa Rican",gov:"Republic",eco:"Tourism",code:"CR"},
  {c:"Japan",cap:"Tokyo",lang:"Japanese",dem:"Japanese",gov:"Constitutional monarchy",eco:"Electronics",code:"JP"},
  {c:"Germany",cap:"Berlin",lang:"German",dem:"German",gov:"Federal republic",eco:"Manufacturing",code:"DE"},
  {c:"Brazil",cap:"Bras√≠lia",lang:"Portuguese",dem:"Brazilian",gov:"Federal republic",eco:"Coffee",code:"BR"},
  {c:"Canada",cap:"Ottawa",lang:"English & French",dem:"Canadian",gov:"Constitutional monarchy",eco:"Energy",code:"CA"},
];
while(DATA.length<110) DATA.push(...DATA.slice(0,110-DATA.length));

let mode="",pool=[],i=0,score=0,lives=3,testLimit=0;

function iso(code){return String.fromCodePoint(...[...code].map(c=>127397+c.charCodeAt()))}

function buildMixed(){
  let p=[];
  DATA.forEach(d=>{
    p.push({q:`Capital of ${d.c}?`,a:d.cap,o:DATA.map(x=>x.cap).filter(x=>x!==d.cap).slice(0,3)});
    p.push({q:`Language of ${d.c}?`,a:d.lang,o:DATA.map(x=>x.lang).filter(x=>x!==d.lang).slice(0,3)});
    p.push({q:`Person from ${d.c}?`,a:d.dem,o:DATA.map(x=>x.dem).filter(x=>x!==d.dem).slice(0,3)});
    p.push({q:`Government of ${d.c}?`,a:d.gov,o:DATA.map(x=>x.gov).filter(x=>x!==d.gov).slice(0,3)});
    p.push({q:`Economy of ${d.c}?`,a:d.eco,o:DATA.map(x=>x.eco).filter(x=>x!==d.eco).slice(0,3)});
  });
  return p.sort(()=>Math.random()-.5);
}

function buildFlags(){
  return DATA.map(d=>({
    q:"Which country has this flag?",
    a:d.c,
    o:DATA.map(x=>x.c).filter(x=>x!==d.c).slice(0,3),
    flag:iso(d.code)
  })).sort(()=>Math.random()-.5);
}

function startClassic(){
  mode="classic";lives=3;score=0;
  pool=buildMixed();startGame();
}
function startCountdown(){
  mode="countdown";lives=999;score=0;
  pool=buildMixed();startGame();
}
function startFlags(){
  mode="flags";lives=3;score=0;
  pool=buildFlags();startGame();
}
function showTestMenu(){
  menu.classList.add("hidden");
  testMenu.classList.remove("hidden");
}
function startTest(n){
  mode="test";testLimit=n;score=0;
  pool=buildMixed().slice(0,n);
  startGame();
}

function startGame(){
  menu.classList.add("hidden");
  testMenu.classList.add("hidden");
  game.classList.remove("hidden");
  i=0;load();
}

function load(){
  if(i>=pool.length || (mode==="test"&&i>=testLimit)){
    alert(`Test finished\nScore: ${score}/${(mode==="test"?testLimit:i)*10}`);
    location.reload();return;
  }
  let q=pool[i];
  question.textContent=q.q;
  options.innerHTML="";
  feedback.classList.add("hidden");
  nextBtn.classList.add("hidden");
  if(q.flag){flagBox.textContent=q.flag;flagBox.classList.remove("hidden")}
  else flagBox.classList.add("hidden");

  [...q.o,q.a].sort(()=>Math.random()-.5).forEach(opt=>{
    let d=document.createElement("div");
    d.className="option";d.textContent=opt;
    d.onclick=()=>answer(d,opt===q.a);
    options.appendChild(d);
  });
  bar.style.width=(i/pool.length*100)+"%";
}

function answer(el,ok){
  if(ok){el.classList.add("correct");score+=10}
  else{el.classList.add("wrong");if(mode!=="test")lives--;feedback.textContent="Correct: "+pool[i].a;feedback.classList.remove("hidden")}
  nextBtn.classList.remove("hidden");
}
nextBtn.onclick=()=>{i++;load()};
</script>
</div>
</body>
</html>
