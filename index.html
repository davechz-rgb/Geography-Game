<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Geography Trainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  :root{
    --bg1:#0b1220;
    --bg2:#0e1a33;
    --card: rgba(255,255,255,.08);
    --card2: rgba(255,255,255,.10);
    --stroke: rgba(255,255,255,.14);
    --text: rgba(255,255,255,.92);
    --muted: rgba(255,255,255,.70);
    --muted2: rgba(255,255,255,.55);
    --accent:#67e8f9;
    --accent2:#a78bfa;
    --good:#22c55e;
    --bad:#ef4444;
    --warn:#f59e0b;
    --shadow: 0 18px 45px rgba(0,0,0,.35);
    --radius: 18px;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
    color: var(--text);
    min-height: 100vh;
    background:
      radial-gradient(1200px 600px at 15% 10%, rgba(103,232,249,.18), transparent 55%),
      radial-gradient(900px 500px at 85% 20%, rgba(167,139,250,.18), transparent 55%),
      radial-gradient(900px 700px at 55% 95%, rgba(34,197,94,.10), transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
  }

  #app{
    max-width: 520px;
    margin: 0 auto;
    padding: 16px 14px 28px;
  }

  /* Topbar */
  .topbar{
    position: sticky;
    top: 0;
    z-index: 50;
    border-radius: 22px;
    padding: 12px 12px 12px;
    background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
    border: 1px solid var(--stroke);
    box-shadow: var(--shadow);
    backdrop-filter: blur(14px);
  }

  .topbarRow{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }

  .brand{
    display:flex;
    align-items:center;
    gap:10px;
    font-weight: 900;
    letter-spacing: .2px;
  }
  .brandIcon{
    width: 38px;
    height: 38px;
    border-radius: 14px;
    display:grid;
    place-items:center;
    background: linear-gradient(135deg, rgba(103,232,249,.20), rgba(167,139,250,.20));
    border: 1px solid rgba(255,255,255,.16);
  }
  .brandTitle{
    display:flex;
    flex-direction:column;
    line-height: 1.05;
  }
  .brandTitle .sub{
    font-size: 12px;
    color: var(--muted2);
    font-weight: 800;
    letter-spacing: .4px;
  }

  .chipRow{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top: 10px;
  }
  .chip{
    display:flex;
    align-items:center;
    gap:8px;
    padding: 8px 10px;
    border-radius: 999px;
    background: rgba(255,255,255,.07);
    border: 1px solid rgba(255,255,255,.12);
    color: var(--muted);
    font-weight: 850;
    font-size: 12px;
  }
  .chip strong{ color: var(--text); font-weight: 950; }

  .menuBtn{
    border:none;
    cursor:pointer;
    border-radius: 14px;
    padding: 10px 12px;
    color: var(--text);
    background: rgba(255,255,255,.10);
    border: 1px solid rgba(255,255,255,.16);
    box-shadow: 0 10px 20px rgba(0,0,0,.18);
    font-weight: 900;
    transition: transform .12s ease, background .12s ease;
  }
  .menuBtn:active{ transform: scale(.98); }

  /* Progress bar */
  .progress{
    height: 10px;
    margin-top: 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.08);
    border: 1px solid rgba(255,255,255,.12);
    overflow:hidden;
  }
  .progress > div{
    height:100%;
    width:0%;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(103,232,249,.95), rgba(167,139,250,.95));
    transition: width .2s ease;
  }

  /* Cards */
  .panel{
    margin-top: 14px;
    border-radius: var(--radius);
    background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
    border: 1px solid var(--stroke);
    box-shadow: var(--shadow);
    backdrop-filter: blur(12px);
    padding: 16px;
  }

  /* Menu */
  .title{
    font-size: 18px;
    font-weight: 1000;
    margin: 0 0 6px;
    letter-spacing: .2px;
  }
  .desc{
    margin: 0 0 14px;
    color: var(--muted);
    line-height: 1.35;
    font-size: 14px;
  }
  .pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    margin-top: 10px;
    padding: 8px 10px;
    border-radius: 999px;
    background: rgba(103,232,249,.10);
    border: 1px solid rgba(103,232,249,.20);
    color: rgba(255,255,255,.86);
    font-weight: 900;
    font-size: 12px;
  }

  .modeGrid{
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
    margin-top: 12px;
  }
  .modeCard{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    padding: 14px;
    border-radius: 16px;
    background: rgba(255,255,255,.08);
    border: 1px solid rgba(255,255,255,.14);
    cursor:pointer;
    transition: transform .12s ease, background .12s ease;
  }
  .modeCard:hover{ background: rgba(255,255,255,.10); }
  .modeCard:active{ transform: scale(.99); }

  .modeLeft{
    display:flex;
    gap:12px;
    align-items:flex-start;
  }
  .modeIcon{
    width: 44px;
    height: 44px;
    border-radius: 16px;
    display:grid;
    place-items:center;
    background: linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
    border: 1px solid rgba(255,255,255,.14);
    font-size: 20px;
  }
  .modeText .h{
    font-weight: 1000;
    letter-spacing: .2px;
    margin-bottom: 3px;
  }
  .modeText .p{
    font-size: 12px;
    color: var(--muted2);
    font-weight: 850;
    line-height: 1.25;
  }
  .arrow{
    opacity: .75;
    font-weight: 1000;
  }

  /* Game */
  .flag{
    font-size: 72px;
    text-align:center;
    margin: 6px 0 10px;
    filter: drop-shadow(0 12px 16px rgba(0,0,0,.28));
  }
  .question{
    font-size: 18px;
    font-weight: 1000;
    line-height: 1.25;
    margin: 0 0 14px;
    letter-spacing: .2px;
  }

  .lifelineRow{
    display:flex;
    gap:10px;
    margin-bottom: 12px;
  }
  .lifelineBtn{
    width:100%;
    border: 1px solid rgba(255,255,255,.16);
    background: rgba(255,255,255,.08);
    color: var(--text);
    padding: 12px 12px;
    border-radius: 16px;
    font-weight: 1000;
    cursor:pointer;
    transition: transform .12s ease, background .12s ease;
  }
  .lifelineBtn:active{ transform: scale(.99); }
  .lifelineBtn:disabled{ opacity:.45; cursor:not-allowed; }

  .options{
    display:grid;
    gap:10px;
  }
  .option{
    padding: 14px;
    border-radius: 16px;
    background: rgba(255,255,255,.08);
    border: 1px solid rgba(255,255,255,.14);
    cursor:pointer;
    user-select:none;
    font-weight: 950;
    line-height: 1.2;
    transition: transform .12s ease, background .12s ease;
  }
  .option:hover{ background: rgba(255,255,255,.10); }
  .option:active{ transform: scale(.99); }
  .option.correct{
    background: rgba(34,197,94,.16);
    border-color: rgba(34,197,94,.30);
  }
  .option.wrong{
    background: rgba(239,68,68,.16);
    border-color: rgba(239,68,68,.30);
  }

  .feedback{
    margin-top: 12px;
    padding: 12px 14px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.08);
    font-weight: 950;
    line-height: 1.25;
  }
  .feedback.good{
    background: rgba(34,197,94,.14);
    border-color: rgba(34,197,94,.28);
  }
  .feedback.bad{
    background: rgba(239,68,68,.14);
    border-color: rgba(239,68,68,.28);
  }

  .primary{
    margin-top: 12px;
    width:100%;
    padding: 13px 14px;
    border-radius: 16px;
    border: 0;
    cursor:pointer;
    font-weight: 1000;
    color: rgba(10,14,24,.95);
    background: linear-gradient(90deg, rgba(103,232,249,.95), rgba(167,139,250,.95));
    box-shadow: 0 18px 30px rgba(0,0,0,.25);
    transition: transform .12s ease, filter .12s ease;
  }
  .primary:active{ transform: scale(.99); }
  .hidden{ display:none; }

  /* Small screens */
  @media (max-width: 380px){
    .brandTitle .sub{ display:none; }
    .chip{ font-size: 11px; }
  }
</style>
</head>

<body>
<div id="app">

  <div class="topbar">
    <div class="topbarRow">
      <div class="brand">
        <div class="brandIcon">üåç</div>
        <div class="brandTitle">
          <div>Geography Trainer</div>
          <div class="sub">Duolingo-style practice ‚Ä¢ Offline</div>
        </div>
      </div>
      <button id="mainMenuBtn" class="menuBtn">üè† Menu</button>
    </div>

    <div class="chipRow">
      <div class="chip">‚ù§Ô∏è Lives: <strong id="lives">3</strong></div>
      <div class="chip">‚è±Ô∏è Time: <strong id="time">--</strong></div>
      <div class="chip">üõü 50/50: <strong id="lifelinesHud">3</strong></div>
      <div class="chip">üèÜ Score: <strong id="score">0</strong></div>
    </div>

    <div class="progress"><div id="bar"></div></div>
  </div>

  <!-- MENU -->
  <div id="menuScreen" class="panel">
    <div class="title">Choose a mode</div>
    <div class="desc">
      Trains capitals, flags, languages, nationalities, government and economy using a <b>110-country dataset</b>.
      <div class="pill">Tip: Classic ‚Üí Countdown ‚Üí Flags</div>
    </div>

    <div class="modeGrid">
      <div id="classicBtn" class="modeCard">
        <div class="modeLeft">
          <div class="modeIcon">‚ù§Ô∏è</div>
          <div class="modeText">
            <div class="h">Classic Practice</div>
            <div class="p">Lives + feedback. Best for learning and retention.</div>
          </div>
        </div>
        <div class="arrow">‚Ä∫</div>
      </div>

      <div id="countdownBtn" class="modeCard">
        <div class="modeLeft">
          <div class="modeIcon">‚è±Ô∏è</div>
          <div class="modeText">
            <div class="h">Countdown</div>
            <div class="p">60s total. +2s per correct. Train speed under pressure.</div>
          </div>
        </div>
        <div class="arrow">‚Ä∫</div>
      </div>

      <div id="flagsBtn" class="modeCard">
        <div class="modeLeft">
          <div class="modeIcon">üö©</div>
          <div class="modeText">
            <div class="h">Flag Match</div>
            <div class="p">Pick the country from the flag (emoji flags, offline).</div>
          </div>
        </div>
        <div class="arrow">‚Ä∫</div>
      </div>
    </div>
  </div>

  <!-- GAME -->
  <div id="gameScreen" class="panel hidden">
    <div id="flagBlock" class="hidden">
      <div class="flag" id="flagEmoji">üè≥Ô∏è</div>
    </div>

    <div class="question" id="question"></div>

    <div class="lifelineRow">
      <button id="lifelineBtn" class="lifelineBtn">üõü 50/50 (3)</button>
    </div>

    <div id="options" class="options"></div>
    <div id="feedback" class="feedback hidden"></div>
    <button id="next" class="primary hidden">Next</button>
  </div>

</div>

<script>
/* ========= 110-COUNTRY DATASET =========
   NOTE: Kept identical logic/features; only UI changed.
*/
const COUNTRIES = [
  {code:"US",name:"United States",capital:"Washington, D.C.",language:"English",demonym:"American",government:"Federal republic",economy:"Technology & services"},
  {code:"CA",name:"Canada",capital:"Ottawa",language:"English & French",demonym:"Canadian",government:"Constitutional monarchy",economy:"Energy & services"},
  {code:"MX",name:"Mexico",capital:"Mexico City",language:"Spanish",demonym:"Mexican",government:"Federal republic",economy:"Manufacturing & oil"},
  {code:"GT",name:"Guatemala",capital:"Guatemala City",language:"Spanish",demonym:"Guatemalan",government:"Republic",economy:"Coffee & agriculture"},
  {code:"HN",name:"Honduras",capital:"Tegucigalpa",language:"Spanish",demonym:"Honduran",government:"Republic",economy:"Agriculture & textiles"},
  {code:"SV",name:"El Salvador",capital:"San Salvador",language:"Spanish",demonym:"Salvadoran",government:"Republic",economy:"Services & manufacturing"},
  {code:"NI",name:"Nicaragua",capital:"Managua",language:"Spanish",demonym:"Nicaraguan",government:"Republic",economy:"Agriculture"},
  {code:"CR",name:"Costa Rica",capital:"San Jos√©",language:"Spanish",demonym:"Costa Rican",government:"Republic",economy:"Services & tourism"},
  {code:"PA",name:"Panama",capital:"Panama City",language:"Spanish",demonym:"Panamanian",government:"Republic",economy:"Canal & services"},
  {code:"CU",name:"Cuba",capital:"Havana",language:"Spanish",demonym:"Cuban",government:"One-party state",economy:"Tourism & services"},
  {code:"DO",name:"Dominican Republic",capital:"Santo Domingo",language:"Spanish",demonym:"Dominican",government:"Republic",economy:"Tourism"},
  {code:"JM",name:"Jamaica",capital:"Kingston",language:"English",demonym:"Jamaican",government:"Constitutional monarchy",economy:"Tourism"},
  {code:"CO",name:"Colombia",capital:"Bogot√°",language:"Spanish",demonym:"Colombian",government:"Republic",economy:"Oil, coffee"},
  {code:"VE",name:"Venezuela",capital:"Caracas",language:"Spanish",demonym:"Venezuelan",government:"Republic",economy:"Oil"},
  {code:"EC",name:"Ecuador",capital:"Quito",language:"Spanish",demonym:"Ecuadorian",government:"Republic",economy:"Oil & agriculture"},
  {code:"PE",name:"Peru",capital:"Lima",language:"Spanish",demonym:"Peruvian",government:"Republic",economy:"Mining"},
  {code:"BO",name:"Bolivia",capital:"Sucre (official) / La Paz (seat)",language:"Spanish",demonym:"Bolivian",government:"Republic",economy:"Mining & gas"},
  {code:"CL",name:"Chile",capital:"Santiago",language:"Spanish",demonym:"Chilean",government:"Republic",economy:"Mining (copper)"},
  {code:"AR",name:"Argentina",capital:"Buenos Aires",language:"Spanish",demonym:"Argentine",government:"Federal republic",economy:"Agriculture & industry"},
  {code:"UY",name:"Uruguay",capital:"Montevideo",language:"Spanish",demonym:"Uruguayan",government:"Republic",economy:"Services & agriculture"},
  {code:"PY",name:"Paraguay",capital:"Asunci√≥n",language:"Spanish & Guaran√≠",demonym:"Paraguayan",government:"Republic",economy:"Agriculture & hydroelectric"},
  {code:"BR",name:"Brazil",capital:"Bras√≠lia",language:"Portuguese",demonym:"Brazilian",government:"Federal republic",economy:"Coffee & soybeans"},
  {code:"GY",name:"Guyana",capital:"Georgetown",language:"English",demonym:"Guyanese",government:"Republic",economy:"Oil & mining"},
  {code:"SR",name:"Suriname",capital:"Paramaribo",language:"Dutch",demonym:"Surinamese",government:"Republic",economy:"Mining"},
  {code:"TT",name:"Trinidad & Tobago",capital:"Port of Spain",language:"English",demonym:"Trinidadian and Tobagonian",government:"Republic",economy:"Oil & gas"},

  {code:"GB",name:"United Kingdom",capital:"London",language:"English",demonym:"British",government:"Constitutional monarchy",economy:"Finance & services"},
  {code:"IE",name:"Ireland",capital:"Dublin",language:"English & Irish",demonym:"Irish",government:"Republic",economy:"Technology & services"},
  {code:"FR",name:"France",capital:"Paris",language:"French",demonym:"French",government:"Republic",economy:"Industry & services"},
  {code:"ES",name:"Spain",capital:"Madrid",language:"Spanish",demonym:"Spanish",government:"Constitutional monarchy",economy:"Tourism & services"},
  {code:"PT",name:"Portugal",capital:"Lisbon",language:"Portuguese",demonym:"Portuguese",government:"Republic",economy:"Tourism & services"},
  {code:"DE",name:"Germany",capital:"Berlin",language:"German",demonym:"German",government:"Federal republic",economy:"Manufacturing"},
  {code:"NL",name:"Netherlands",capital:"Amsterdam",language:"Dutch",demonym:"Dutch",government:"Constitutional monarchy",economy:"Trade & services"},
  {code:"BE",name:"Belgium",capital:"Brussels",language:"Dutch, French, German",demonym:"Belgian",government:"Constitutional monarchy",economy:"Industry & services"},
  {code:"LU",name:"Luxembourg",capital:"Luxembourg",language:"Luxembourgish, French, German",demonym:"Luxembourger",government:"Constitutional monarchy",economy:"Finance"},
  {code:"CH",name:"Switzerland",capital:"Bern",language:"German, French, Italian, Romansh",demonym:"Swiss",government:"Federal republic",economy:"Finance & pharma"},
  {code:"IT",name:"Italy",capital:"Rome",language:"Italian",demonym:"Italian",government:"Republic",economy:"Manufacturing"},
  {code:"AT",name:"Austria",capital:"Vienna",language:"German",demonym:"Austrian",government:"Republic",economy:"Industry & services"},
  {code:"DK",name:"Denmark",capital:"Copenhagen",language:"Danish",demonym:"Danish",government:"Constitutional monarchy",economy:"Services"},
  {code:"SE",name:"Sweden",capital:"Stockholm",language:"Swedish",demonym:"Swedish",government:"Constitutional monarchy",economy:"Manufacturing & tech"},
  {code:"NO",name:"Norway",capital:"Oslo",language:"Norwegian",demonym:"Norwegian",government:"Constitutional monarchy",economy:"Oil & gas"},
  {code:"FI",name:"Finland",capital:"Helsinki",language:"Finnish & Swedish",demonym:"Finnish",government:"Republic",economy:"Technology"},
  {code:"IS",name:"Iceland",capital:"Reykjav√≠k",language:"Icelandic",demonym:"Icelandic",government:"Republic",economy:"Fishing & tourism"},
  {code:"PL",name:"Poland",capital:"Warsaw",language:"Polish",demonym:"Polish",government:"Republic",economy:"Manufacturing"},
  {code:"CZ",name:"Czechia",capital:"Prague",language:"Czech",demonym:"Czech",government:"Republic",economy:"Manufacturing"},
  {code:"SK",name:"Slovakia",capital:"Bratislava",language:"Slovak",demonym:"Slovak",government:"Republic",economy:"Manufacturing"},
  {code:"HU",name:"Hungary",capital:"Budapest",language:"Hungarian",demonym:"Hungarian",government:"Republic",economy:"Manufacturing"},
  {code:"RO",name:"Romania",capital:"Bucharest",language:"Romanian",demonym:"Romanian",government:"Republic",economy:"Industry"},
  {code:"BG",name:"Bulgaria",capital:"Sofia",language:"Bulgarian",demonym:"Bulgarian",government:"Republic",economy:"Industry"},
  {code:"GR",name:"Greece",capital:"Athens",language:"Greek",demonym:"Greek",government:"Republic",economy:"Tourism & shipping"},
  {code:"HR",name:"Croatia",capital:"Zagreb",language:"Croatian",demonym:"Croatian",government:"Republic",economy:"Tourism"},
  {code:"RS",name:"Serbia",capital:"Belgrade",language:"Serbian",demonym:"Serbian",government:"Republic",economy:"Industry"},
  {code:"BA",name:"Bosnia and Herzegovina",capital:"Sarajevo",language:"Bosnian/Croatian/Serbian",demonym:"Bosnian",government:"Republic",economy:"Industry"},
  {code:"AL",name:"Albania",capital:"Tirana",language:"Albanian",demonym:"Albanian",government:"Republic",economy:"Services"},
  {code:"MK",name:"North Macedonia",capital:"Skopje",language:"Macedonian",demonym:"Macedonian",government:"Republic",economy:"Services"},
  {code:"SI",name:"Slovenia",capital:"Ljubljana",language:"Slovene",demonym:"Slovene",government:"Republic",economy:"Industry"},
  {code:"UA",name:"Ukraine",capital:"Kyiv",language:"Ukrainian",demonym:"Ukrainian",government:"Republic",economy:"Agriculture"},
  {code:"RU",name:"Russia",capital:"Moscow",language:"Russian",demonym:"Russian",government:"Federation",economy:"Oil & gas"},
  {code:"TR",name:"Turkey",capital:"Ankara",language:"Turkish",demonym:"Turkish",government:"Republic",economy:"Manufacturing"},
  {code:"AD",name:"Andorra",capital:"Andorra la Vella",language:"Catalan",demonym:"Andorran",government:"Co-principality",economy:"Tourism"},
  {code:"MC",name:"Monaco",capital:"Monaco",language:"French",demonym:"Monegasque",government:"Constitutional monarchy",economy:"Finance & tourism"},
  {code:"SM",name:"San Marino",capital:"San Marino",language:"Italian",demonym:"Sammarinese",government:"Republic",economy:"Tourism"},
  {code:"VA",name:"Vatican City",capital:"Vatican City",language:"Italian/Latin",demonym:"Vatican",government:"Theocracy",economy:"Tourism"},
  {code:"MD",name:"Moldova",capital:"Chi»ôinƒÉu",language:"Romanian",demonym:"Moldovan",government:"Republic",economy:"Agriculture"},

  {code:"MA",name:"Morocco",capital:"Rabat",language:"Arabic",demonym:"Moroccan",government:"Constitutional monarchy",economy:"Tourism & agriculture"},
  {code:"DZ",name:"Algeria",capital:"Algiers",language:"Arabic",demonym:"Algerian",government:"Republic",economy:"Oil & gas"},
  {code:"TN",name:"Tunisia",capital:"Tunis",language:"Arabic",demonym:"Tunisian",government:"Republic",economy:"Tourism"},
  {code:"EG",name:"Egypt",capital:"Cairo",language:"Arabic",demonym:"Egyptian",government:"Republic",economy:"Tourism & services"},
  {code:"NG",name:"Nigeria",capital:"Abuja",language:"English",demonym:"Nigerian",government:"Federal republic",economy:"Oil"},
  {code:"GH",name:"Ghana",capital:"Accra",language:"English",demonym:"Ghanaian",government:"Republic",economy:"Cocoa & gold"},
  {code:"CI",name:"C√¥te d‚ÄôIvoire",capital:"Yamoussoukro",language:"French",demonym:"Ivorian",government:"Republic",economy:"Cocoa"},
  {code:"SN",name:"Senegal",capital:"Dakar",language:"French",demonym:"Senegalese",government:"Republic",economy:"Fishing & services"},
  {code:"ET",name:"Ethiopia",capital:"Addis Ababa",language:"Amharic",demonym:"Ethiopian",government:"Federation",economy:"Agriculture"},
  {code:"KE",name:"Kenya",capital:"Nairobi",language:"Swahili & English",demonym:"Kenyan",government:"Republic",economy:"Agriculture & tourism"},
  {code:"TZ",name:"Tanzania",capital:"Dodoma",language:"Swahili",demonym:"Tanzanian",government:"Republic",economy:"Tourism & agriculture"},
  {code:"UG",name:"Uganda",capital:"Kampala",language:"English & Swahili",demonym:"Ugandan",government:"Republic",economy:"Agriculture"},
  {code:"RW",name:"Rwanda",capital:"Kigali",language:"Kinyarwanda, English, French",demonym:"Rwandan",government:"Republic",economy:"Services"},
  {code:"ZA",name:"South Africa",capital:"Pretoria",language:"English & others",demonym:"South African",government:"Republic",economy:"Mining"},
  {code:"AO",name:"Angola",capital:"Luanda",language:"Portuguese",demonym:"Angolan",government:"Republic",economy:"Oil"},
  {code:"MZ",name:"Mozambique",capital:"Maputo",language:"Portuguese",demonym:"Mozambican",government:"Republic",economy:"Agriculture & gas"},
  {code:"ZW",name:"Zimbabwe",capital:"Harare",language:"English & others",demonym:"Zimbabwean",government:"Republic",economy:"Mining"},
  {code:"ZM",name:"Zambia",capital:"Lusaka",language:"English",demonym:"Zambian",government:"Republic",economy:"Mining (copper)"},
  {code:"NA",name:"Namibia",capital:"Windhoek",language:"English",demonym:"Namibian",government:"Republic",economy:"Mining"},
  {code:"BW",name:"Botswana",capital:"Gaborone",language:"English",demonym:"Motswana",government:"Republic",economy:"Diamonds"},
  {code:"MG",name:"Madagascar",capital:"Antananarivo",language:"Malagasy & French",demonym:"Malagasy",government:"Republic",economy:"Agriculture"},
  {code:"SD",name:"Sudan",capital:"Khartoum",language:"Arabic",demonym:"Sudanese",government:"Republic",economy:"Agriculture"},
  {code:"CM",name:"Cameroon",capital:"Yaound√©",language:"French & English",demonym:"Cameroonian",government:"Republic",economy:"Oil & agriculture"},
  {code:"CD",name:"DR Congo",capital:"Kinshasa",language:"French",demonym:"Congolese",government:"Republic",economy:"Mining"},

  {code:"SA",name:"Saudi Arabia",capital:"Riyadh",language:"Arabic",demonym:"Saudi",government:"Absolute monarchy",economy:"Oil"},
  {code:"AE",name:"United Arab Emirates",capital:"Abu Dhabi",language:"Arabic",demonym:"Emirati",government:"Federation",economy:"Oil & services"},
  {code:"QA",name:"Qatar",capital:"Doha",language:"Arabic",demonym:"Qatari",government:"Monarchy",economy:"Gas"},
  {code:"KW",name:"Kuwait",capital:"Kuwait City",language:"Arabic",demonym:"Kuwaiti",government:"Monarchy",economy:"Oil"},
  {code:"OM",name:"Oman",capital:"Muscat",language:"Arabic",demonym:"Omani",government:"Monarchy",economy:"Oil & services"},
  {code:"IL",name:"Israel",capital:"Jerusalem",language:"Hebrew",demonym:"Israeli",government:"Republic",economy:"Technology"},
  {code:"JO",name:"Jordan",capital:"Amman",language:"Arabic",demonym:"Jordanian",government:"Constitutional monarchy",economy:"Services"},
  {code:"LB",name:"Lebanon",capital:"Beirut",language:"Arabic",demonym:"Lebanese",government:"Republic",economy:"Services"},
  {code:"IR",name:"Iran",capital:"Tehran",language:"Farsi",demonym:"Iranian",government:"Republic",economy:"Oil & gas"},
  {code:"IQ",name:"Iraq",capital:"Baghdad",language:"Arabic",demonym:"Iraqi",government:"Republic",economy:"Oil"},
  {code:"AF",name:"Afghanistan",capital:"Kabul",language:"Dari and Pashto",demonym:"Afghan",government:"Republic",economy:"Agriculture"},
  {code:"PK",name:"Pakistan",capital:"Islamabad",language:"Urdu",demonym:"Pakistani",government:"Republic",economy:"Textiles"},
  {code:"IN",name:"India",capital:"New Delhi",language:"Hindi & English",demonym:"Indian",government:"Federal republic",economy:"Services & IT"},
  {code:"BD",name:"Bangladesh",capital:"Dhaka",language:"Bengali",demonym:"Bangladeshi",government:"Republic",economy:"Textiles"},
  {code:"NP",name:"Nepal",capital:"Kathmandu",language:"Nepali",demonym:"Nepali",government:"Federal republic",economy:"Tourism"},
  {code:"LK",name:"Sri Lanka",capital:"Sri Jayawardenepura Kotte",language:"Sinhala & Tamil",demonym:"Sri Lankan",government:"Republic",economy:"Tea"},
  {code:"TH",name:"Thailand",capital:"Bangkok",language:"Thai",demonym:"Thai",government:"Constitutional monarchy",economy:"Tourism"},
  {code:"VN",name:"Vietnam",capital:"Hanoi",language:"Vietnamese",demonym:"Vietnamese",government:"One-party state",economy:"Manufacturing"},
  {code:"SG",name:"Singapore",capital:"Singapore",language:"English, Malay, Chinese, Tamil",demonym:"Singaporean",government:"Republic",economy:"Finance & trade"},
  {code:"MY",name:"Malaysia",capital:"Kuala Lumpur",language:"Malay",demonym:"Malaysian",government:"Constitutional monarchy",economy:"Manufacturing"},
  {code:"ID",name:"Indonesia",capital:"Jakarta",language:"Indonesian",demonym:"Indonesian",government:"Republic",economy:"Manufacturing"},
  {code:"PH",name:"Philippines",capital:"Manila",language:"Filipino & English",demonym:"Filipino",government:"Republic",economy:"Services"},
  {code:"CN",name:"China",capital:"Beijing",language:"Chinese (Mandarin)",demonym:"Chinese",government:"One-party state",economy:"Manufacturing"},
  {code:"JP",name:"Japan",capital:"Tokyo",language:"Japanese",demonym:"Japanese",government:"Constitutional monarchy",economy:"Cars & electronics"},
  {code:"KR",name:"South Korea",capital:"Seoul",language:"Korean",demonym:"South Korean",government:"Republic",economy:"Electronics"},
  {code:"KP",name:"North Korea",capital:"Pyongyang",language:"Korean",demonym:"North Korean",government:"One-party state",economy:"Industry"},
  {code:"MN",name:"Mongolia",capital:"Ulaanbaatar",language:"Mongolian",demonym:"Mongolian",government:"Republic",economy:"Mining"},
  {code:"KZ",name:"Kazakhstan",capital:"Astana",language:"Kazakh & Russian",demonym:"Kazakhstani",government:"Republic",economy:"Oil & mining"},
  {code:"UZ",name:"Uzbekistan",capital:"Tashkent",language:"Uzbek",demonym:"Uzbekistani",government:"Republic",economy:"Cotton"},
  {code:"AU",name:"Australia",capital:"Canberra",language:"English",demonym:"Australian",government:"Constitutional monarchy",economy:"Mining"},
  {code:"NZ",name:"New Zealand",capital:"Wellington",language:"English",demonym:"New Zealander",government:"Constitutional monarchy",economy:"Agriculture"},
];

const byName = new Map();
for (const c of COUNTRIES) byName.set(c.name, c);
const COUNTRY_DATA = Array.from(byName.values());

/* ========= Utils ========= */
function shuffle(arr){ return arr.sort(()=>Math.random() - 0.5); }
function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }
function isoToFlagEmoji(iso2){
  const code = iso2.toUpperCase();
  const A = 0x1F1E6;
  const first = code.charCodeAt(0) - 65 + A;
  const second = code.charCodeAt(1) - 65 + A;
  return String.fromCodePoint(first, second);
}
function sampleDistinct(arr, n, excludeSet = new Set()){
  const pool = arr.filter(x => !excludeSet.has(x));
  return shuffle(pool).slice(0, n);
}

/* ========= Generators ========= */
const TOPICS = ["capital","language","demonym","government","economy"];
function makeQuestionFromCountry(country, topic){
  const name = country.name;
  if(topic === "capital"){
    const correct = country.capital;
    const distractors = sampleDistinct(COUNTRY_DATA.map(c=>c.capital), 3, new Set([correct]));
    return {type:"mc", q:`What is the capital of ${name}?`, a:correct, o:distractors};
  }
  if(topic === "language"){
    const correct = country.language;
    const distractors = sampleDistinct(COUNTRY_DATA.map(c=>c.language), 3, new Set([correct]));
    return {type:"mc", q:`What language is spoken in ${name}?`, a:correct, o:distractors};
  }
  if(topic === "demonym"){
    const correct = country.demonym;
    const distractors = sampleDistinct(COUNTRY_DATA.map(c=>c.demonym), 3, new Set([correct]));
    return {type:"mc", q:`A person from ${name} is:`, a:correct, o:distractors};
  }
  if(topic === "government"){
    const correct = country.government;
    const distractors = sampleDistinct(COUNTRY_DATA.map(c=>c.government), 3, new Set([correct]));
    return {type:"mc", q:`${name} has what type of government?`, a:correct, o:distractors};
  }
  const correct = country.economy;
  const distractors = sampleDistinct(COUNTRY_DATA.map(c=>c.economy), 3, new Set([correct]));
  return {type:"mc", q:`${name} is known for an economy based on:`, a:correct, o:distractors};
}
function buildMixedQuestionPool(){
  const pool = [];
  for(const c of COUNTRY_DATA){
    for(const t of TOPICS) pool.push(makeQuestionFromCountry(c,t));
  }
  return shuffle(pool);
}
function makeFlagQuestion(){
  const correctCountry = COUNTRY_DATA[Math.floor(Math.random() * COUNTRY_DATA.length)];
  const correct = correctCountry.name;
  const flag = isoToFlagEmoji(correctCountry.code);
  const wrongs = sampleDistinct(COUNTRY_DATA.map(c=>c.name), 3, new Set([correct]));
  return {type:"flag", flag, q:"Which country has this flag?", a:correct, o:wrongs};
}
function buildFlagPool(n=120){
  const pool = [];
  for(let i=0;i<n;i++) pool.push(makeFlagQuestion());
  return shuffle(pool);
}

/* ========= State ========= */
let mode = "classic";
let pool = [];
let idx = 0;
let score = 0;
let lives = 3;
let inGame = false;
let answered = false;

let timerId = null;
let timeLeftMs = 0;

let lifelinesLeft = 3;

/* ========= Elements ========= */
const menuScreen = document.getElementById("menuScreen");
const gameScreen = document.getElementById("gameScreen");
const flagBlock = document.getElementById("flagBlock");
const flagEmojiEl = document.getElementById("flagEmoji");

const qEl = document.getElementById("question");
const oEl = document.getElementById("options");
const feedbackEl = document.getElementById("feedback");
const nextBtn = document.getElementById("next");

const bar = document.getElementById("bar");
const livesEl = document.getElementById("lives");
const scoreEl = document.getElementById("score");
const timeEl  = document.getElementById("time");
const lifelinesHud = document.getElementById("lifelinesHud");

const mainMenuBtn = document.getElementById("mainMenuBtn");
const classicBtn = document.getElementById("classicBtn");
const countdownBtn = document.getElementById("countdownBtn");
const flagsBtn = document.getElementById("flagsBtn");
const lifelineBtn = document.getElementById("lifelineBtn");

/* ========= UI Helpers ========= */
function setHUD(){
  livesEl.textContent = lives;
  scoreEl.textContent = score;

  if(mode === "countdown"){
    const secs = Math.max(0, Math.ceil(timeLeftMs / 1000));
    timeEl.textContent = secs + "s";
  } else {
    timeEl.textContent = "--";
  }

  lifelinesHud.textContent = lifelinesLeft;
  lifelineBtn.textContent = `üõü 50/50 (${lifelinesLeft})`;
}
function setFeedback(type, html){
  feedbackEl.classList.remove("hidden","good","bad");
  feedbackEl.classList.add(type === "good" ? "good" : "bad");
  feedbackEl.innerHTML = html;
}
function clearFeedback(){
  feedbackEl.classList.add("hidden");
  feedbackEl.classList.remove("good","bad");
  feedbackEl.innerHTML = "";
}
function disableOptions(){ document.querySelectorAll(".option").forEach(o=>o.onclick=null); }
function showMenu(){
  stopTimer();
  menuScreen.classList.remove("hidden");
  gameScreen.classList.add("hidden");
  inGame=false; answered=false;
  bar.style.width="0%";
  clearFeedback();
  nextBtn.classList.add("hidden");
  flagBlock.classList.add("hidden");
}
function endGame(message){
  stopTimer();
  inGame=false; answered=true;
  qEl.innerHTML = message;
  oEl.innerHTML = `<div class="desc" style="margin:0;">Final Score: <b>${score}</b></div>`;
  clearFeedback();
  nextBtn.classList.add("hidden");
  lifelineBtn.disabled = true;
  if(mode !== "countdown") bar.style.width="100%";
}
function buildOption(optText, isCorrect){
  const d = document.createElement("div");
  d.className="option";
  d.textContent=optText;
  d.dataset.correct = isCorrect ? "1":"0";
  d.onclick=()=>selectAnswer(d, isCorrect);
  return d;
}

/* ========= Game Start ========= */
function resetRunCommon(){
  idx=0; score=0; answered=false;
  lifelinesLeft=3;
  lifelineBtn.disabled=false;
  clearFeedback();
  nextBtn.classList.add("hidden");
}
function startClassic(){
  mode="classic";
  resetRunCommon();
  lives=3;
  pool = buildMixedQuestionPool(); // 550 Qs
  inGame=true;
  menuScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  flagBlock.classList.add("hidden");
  setHUD();
  loadQuestion();
}
function startCountdown(){
  mode="countdown";
  resetRunCommon();
  lives=999;
  pool = buildMixedQuestionPool();
  inGame=true;
  timeLeftMs=60000;
  menuScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  flagBlock.classList.add("hidden");
  setHUD();
  loadQuestion();
  startTimer();
}
function startFlags(){
  mode="flags";
  resetRunCommon();
  lives=3;
  pool = buildFlagPool(120);
  inGame=true;
  menuScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  setHUD();
  loadQuestion();
}

/* ========= Load Question ========= */
function loadQuestion(){
  if(!inGame) return;

  clearFeedback();
  nextBtn.classList.add("hidden");
  answered=false;

  lifelineBtn.disabled = (lifelinesLeft <= 0);

  if((mode==="classic" || mode==="flags") && lives<=0){
    endGame("‚ùå Game Over");
    return;
  }

  if(mode !== "countdown" && idx >= pool.length){
    endGame("üéâ You finished!");
    return;
  }

  if(mode === "countdown" && idx >= pool.length){
    pool = buildMixedQuestionPool();
    idx = 0;
  }

  const q = pool[idx];

  if(q.type === "flag"){
    flagBlock.classList.remove("hidden");
    flagEmojiEl.textContent = q.flag;
  }else{
    flagBlock.classList.add("hidden");
  }

  qEl.textContent = q.q;

  oEl.innerHTML = "";
  const opts = shuffle([q.a, ...q.o]);
  opts.forEach(opt => oEl.appendChild(buildOption(opt, opt === q.a)));

  if(mode==="classic" || mode==="flags"){
    const progress = (idx / pool.length) * 100;
    bar.style.width = progress + "%";
  }else{
    const pct = clamp((timeLeftMs / 60000) * 100, 0, 100);
    bar.style.width = pct + "%";
  }

  setHUD();
}

/* ========= Answer ========= */
function selectAnswer(el, correct){
  if(answered) return;
  answered=true;

  disableOptions();
  lifelineBtn.disabled=true;

  const q = pool[idx];

  if(correct){
    el.classList.add("correct");
    score += 10;

    if(mode==="countdown"){
      timeLeftMs += 2000;
      setFeedback("good", `‚úÖ Correct! <b>+2 seconds</b>`);
    }else{
      setFeedback("good", `‚úÖ Correct!`);
    }
  }else{
    el.classList.add("wrong");
    document.querySelectorAll(".option").forEach(optDiv=>{
      if(optDiv.textContent === q.a) optDiv.classList.add("correct");
    });

    if(mode==="classic" || mode==="flags") lives -= 1;
    setFeedback("bad", `‚ùå Not quite. The correct answer is: <b>${q.a}</b>`);
  }

  setHUD();
  nextBtn.classList.remove("hidden");
}
nextBtn.onclick = ()=>{
  if(!inGame) return;
  idx++;
  loadQuestion();
};

/* ========= 50/50 Lifeline ========= */
lifelineBtn.onclick = ()=>{
  if(!inGame || answered || lifelinesLeft<=0) return;

  const optionDivs = Array.from(document.querySelectorAll(".option"));
  if(optionDivs.length < 4) return;

  const wrongDivs = optionDivs.filter(d => d.dataset.correct === "0");
  const keepWrong = wrongDivs[Math.floor(Math.random() * wrongDivs.length)];
  wrongDivs.filter(d => d !== keepWrong).forEach(d => d.remove());

  lifelinesLeft -= 1;
  setHUD();
  lifelineBtn.disabled = (lifelinesLeft <= 0);
};

/* ========= Countdown Timer ========= */
function startTimer(){
  stopTimer();
  timerId = setInterval(()=>{
    if(!inGame || mode!=="countdown") return;

    timeLeftMs -= 250;
    if(timeLeftMs <= 0){
      timeLeftMs = 0;
      setHUD();
      disableOptions();
      endGame("‚è±Ô∏è Time's up!");
      return;
    }

    setHUD();
    const pct = clamp((timeLeftMs / 60000) * 100, 0, 100);
    bar.style.width = pct + "%";
  }, 250);
}
function stopTimer(){
  if(timerId){ clearInterval(timerId); timerId=null; }
}

/* ========= Menu ========= */
mainMenuBtn.onclick = ()=>{
  if(inGame){
    const ok = confirm("Leave the game and go back to Menu? Your run will reset.");
    if(!ok) return;
  }
  showMenu();
};
classicBtn.onclick = startClassic;
countdownBtn.onclick = startCountdown;
flagsBtn.onclick = startFlags;

/* Boot */
showMenu();
setHUD();
</script>
</body>
</html>