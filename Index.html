<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Geo Kombat — Exam Prep</title>
<style>
  :root{
    --bg:#070a12;
    --panel:rgba(255,255,255,.06);
    --panel2:rgba(255,255,255,.04);
    --line:rgba(255,255,255,.10);
    --text:#eef1ff;
    --muted:#aab6d6;
    --muted2:#7f89b6;
    --good:#2cff88;
    --bad:#ff4b67;
    --warn:#ffd166;
    --brand:#5d6bff;
    --shadow:0 18px 60px rgba(0,0,0,.55);
    --r:18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background:
      radial-gradient(1100px 600px at 20% 0%, rgba(93,107,255,.22), transparent 60%),
      radial-gradient(900px 500px at 90% 10%, rgba(255,209,102,.10), transparent 55%),
      radial-gradient(900px 700px at 50% 120%, rgba(44,255,136,.10), transparent 60%),
      var(--bg);
    color:var(--text);
    display:flex;
    justify-content:center;
    padding:18px;
  }
  .app{
    width:min(1120px, 100%);
    border-radius:22px;
    background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
    border:1px solid rgba(255,255,255,.10);
    box-shadow: var(--shadow);
    overflow:hidden;
  }
  header{
    padding:16px 18px;
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:space-between;
    border-bottom:1px solid var(--line);
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  }
  .title{display:flex; gap:12px; align-items:center}
  .logo{
    width:34px; height:34px; border-radius:12px;
    background: linear-gradient(135deg, rgba(93,107,255,.95), rgba(124,140,255,.55));
    display:grid; place-items:center;
    font-weight:950;
  }
  h1{margin:0; font-size:16px; letter-spacing:.2px; line-height:1.1}
  .subtitle{margin-top:3px; font-size:12px; color:var(--muted)}
  .topActions{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end}
  .btn{
    appearance:none;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.04);
    color: var(--text);
    padding:9px 12px;
    border-radius:999px;
    cursor:pointer;
    font-weight:800;
    font-size:12px;
    transition:.15s transform, .15s background, .15s border-color;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
  }
  .btn:hover{transform: translateY(-1px); border-color: rgba(93,107,255,.55)}
  .btn:active{transform: translateY(0px)}
  .btn.primary{background: rgba(93,107,255,.22); border-color: rgba(93,107,255,.40)}
  .btn.good{background: rgba(44,255,136,.12); border-color: rgba(44,255,136,.30)}
  .btn.warn{background: rgba(255,209,102,.10); border-color: rgba(255,209,102,.35)}
  .btn:disabled{opacity:.45; cursor:not-allowed; transform:none}
  main{padding:16px}
  .grid{display:grid; grid-template-columns: 1.2fr 1.8fr; gap:14px}
  @media (max-width: 920px){.grid{grid-template-columns:1fr}}
  .card{
    border:1px solid var(--line);
    background: rgba(0,0,0,.18);
    border-radius: var(--r);
    padding:14px;
  }
  .card h2{
    margin:0 0 10px;
    font-size:13px;
    color: var(--muted);
    font-weight:900;
    letter-spacing:.2px;
    text-transform: uppercase;
  }
  .chips{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
  .chip{
    display:flex; gap:8px; align-items:center;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.04);
    border-radius: 999px;
    padding:8px 10px;
    font-size:12px;
    color: var(--muted);
  }
  .chip b{color:var(--text); font-weight:900}
  .dot{width:8px; height:8px; border-radius:99px; background: rgba(93,107,255,.7)}
  .controls{display:flex; flex-wrap:wrap; gap:10px; align-items:flex-end}
  label{
    font-size:12px;
    color: var(--muted);
    display:flex;
    flex-direction:column;
    gap:6px;
    min-width: 220px;
  }
  select{
    width:100%;
    padding:10px 10px;
    border-radius: 12px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.28);
    color: var(--text);
    font-weight:800;
    outline:none;
  }
  .note{
    font-size:12px;
    color: var(--muted);
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.03);
    border-radius: 12px;
    padding:9px 10px;
    line-height:1.35;
  }

  .arena{
    margin-top:14px;
    border:1px solid var(--line);
    background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,.25));
    border-radius: 22px;
    overflow:hidden;
    min-height: 430px;
    position:relative;
  }
  .arena::before{
    content:"";
    position:absolute; inset:-2px;
    background:
      radial-gradient(820px 360px at 35% 0%, rgba(93,107,255,.14), transparent 65%),
      radial-gradient(740px 300px at 80% 20%, rgba(44,255,136,.10), transparent 65%);
    pointer-events:none;
  }
  .arenaTop{
    padding:14px 14px 0 14px;
    display:flex; align-items:flex-start; justify-content:space-between;
    gap:10px;
    position:relative;
  }
  .modeTag{font-size:12px; color:var(--muted); font-weight:900; letter-spacing:.2px}
  .bigTimer{
    font-size: 58px;
    font-weight: 1000;
    letter-spacing: 1px;
    color: var(--warn);
    line-height: 1;
    display:none;
    text-shadow: 0 10px 28px rgba(0,0,0,.55);
  }
  .arenaBody{padding:14px; position:relative}
  .qTitle{margin:6px 0 6px; font-size: 28px; letter-spacing: .2px; line-height: 1.15}
  .qSub{color: var(--muted); font-size: 13px}
  .answers{
    margin-top: 14px;
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:10px;
  }
  @media (max-width: 720px){.answers{grid-template-columns: 1fr}}
  .ans{
    appearance:none;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.04);
    color: var(--text);
    padding: 14px 14px;
    border-radius: 14px;
    cursor:pointer;
    font-weight:900;
    text-align:left;
    transition:.12s transform, .12s border-color, .12s background;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
  }
  .ans:hover{transform: translateY(-1px); border-color: rgba(93,107,255,.55); background: rgba(93,107,255,.08)}
  .ans:active{transform: translateY(0)}
  .ans[disabled]{opacity:.40; cursor:not-allowed; transform:none}
  .ans.correct{background: rgba(44,255,136,.10); border-color: rgba(44,255,136,.55)}
  .ans.wrong{background: rgba(255,75,103,.10); border-color: rgba(255,75,103,.55)}
  .arenaBottom{
    padding: 0 14px 14px 14px;
    display:flex;
    justify-content:space-between;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
    position:relative;
  }
  .hint{
    flex: 1 1 380px;
    min-width: 260px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.03);
    border-radius: 14px;
    padding:10px 12px;
    font-size:12px;
    color: var(--muted);
    line-height:1.35;
  }
  .hint b{color:var(--text)}
  .results{
    margin-top:14px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.16);
    border-radius: 18px;
    padding:14px;
    display:none;
  }
  .scoreBig{margin:0; font-size: 30px; font-weight: 1000}
  .missList{margin-top:10px; display:grid; gap:10px}
  .missItem{
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.03);
    border-radius: 16px;
    padding:12px;
  }
  .missItem .t{font-weight:950; margin-bottom:6px}
  .missItem .m{color:var(--muted); font-size:12px; line-height:1.35}
  .kbd{
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    font-size:11px;
    padding:2px 6px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.05);
    color:var(--text);
  }
  .toast{
    position:fixed;
    left:50%;
    transform: translateX(-50%);
    bottom: 16px;
    background: rgba(15,23,48,.92);
    border:1px solid rgba(255,255,255,.12);
    color:var(--text);
    padding:10px 12px;
    border-radius: 14px;
    box-shadow: var(--shadow);
    font-size:12px;
    opacity:0;
    pointer-events:none;
    transition: opacity .18s ease, transform .18s ease;
  }
  .toast.show{opacity:1; transform: translateX(-50%) translateY(-4px)}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="title">
      <div class="logo">G</div>
      <div>
        <h1>Geo Kombat</h1>
        <div class="subtitle">Exam-aligned: Flags · Capitals · Language · Nationality · Government · Economy</div>
      </div>
    </div>
    <div class="topActions">
      <button class="btn" id="btnMenu">Main Menu</button>
      <button class="btn warn" id="btnRestart">Restart</button>
      <button class="btn good" id="btnLifeline">Lifeline (<span id="lifelines">3</span>)</button>
    </div>
  </header>

  <main>
    <div class="grid">
      <div class="card">
        <h2>Status</h2>
        <div class="chips">
          <div class="chip"><span class="dot"></span> Countries: <b id="countryCount">0</b></div>
          <div class="chip">Mode: <b id="modeLabel">Menu</b></div>
          <div class="chip">XP: <b id="xp">0</b></div>
          <div class="chip">Streak: <b id="streak">0</b></div>
          <div class="chip">Accuracy: <b id="acc">—</b></div>
          <div class="chip" id="examProgWrap" style="display:none">Progress: <b id="examProg">1/30</b></div>
        </div>
        <div class="note" style="margin-top:12px">
          Multiple-choice only. Hard distractors are picked from similar regions / patterns when possible. Shortcuts: <span class="kbd">1</span>–<span class="kbd">4</span>.
        </div>
      </div>

      <div class="card">
        <h2>Play</h2>
        <div class="controls">
          <label>
            Mode
            <select id="modeSelect">
              <option value="study">Study (endless)</option>
              <option value="exam" selected>Exam</option>
              <option value="time">Time Attack (60s)</option>
            </select>
          </label>
          <label>
            Exam questions
            <select id="examCount">
              <option value="10">10</option>
              <option value="20">20</option>
              <option value="30" selected>30</option>
              <option value="40">40</option>
              <option value="60">60</option>
            </select>
          </label>
          <button class="btn primary" id="btnStart">Start</button>
        </div>
        <div class="note" style="margin-top:12px">
          Lifeline removes <b>two wrong</b> answers (max 3 per run). In Exam, you must answer before Next. In Time Attack, answer as many as possible.
        </div>
      </div>
    </div>

    <div class="arena" id="arena">
      <div class="arenaTop">
        <div>
          <div class="modeTag" id="topicTag">Ready</div>
          <div class="qSub" id="metaLine"></div>
        </div>
        <div class="bigTimer" id="timer">60</div>
      </div>

      <div class="arenaBody">
        <div class="qTitle" id="qTitle">Choose a mode and press Start.</div>
        <div class="qSub" id="qSub"></div>

        <div class="answers" id="answers"></div>
      </div>

      <div class="arenaBottom">
        <div class="hint" id="hint"><b>Hint</b>: Use Lifeline when answers look too similar — it removes 2 wrong options.</div>
        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <button class="btn primary" id="btnNext">Next</button>
        </div>
      </div>
    </div>

    <div class="results" id="results">
      <p class="scoreBig" id="finalScore">Score: 0/100</p>
      <div class="note" id="finalMeta" style="margin-top:10px"></div>
      <div class="missList" id="missList"></div>
    </div>
  </main>
</div>

<div class="toast" id="toast"></div>

<script id="countriesData" type="application/json">[{"name": "Djibouti", "code": "DJ", "capital": "Djibouti", "languages": ["French", "Arabic"], "demonym": "Djibouti", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Tuvalu", "code": "TV", "capital": "Funafuti", "languages": ["English"], "demonym": "Tuvaluan", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Bhutan", "code": "BT", "capital": "Thimphu", "languages": ["Dzongkha"], "demonym": "Bhutanese", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Colombia", "code": "CO", "capital": "Bogotá", "languages": ["Spanish"], "demonym": "Colombian", "region": "Americas", "subregion": "South America"}, {"name": "Cook Islands", "code": "CK", "capital": "Avarua", "languages": ["English"], "demonym": "Cook Islander", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Laos", "code": "LA", "capital": "Vientiane", "languages": ["Lao"], "demonym": "Laotian", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Bulgaria", "code": "BG", "capital": "Sofia", "languages": ["Bulgarian"], "demonym": "Bulgarian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Mauritania", "code": "MR", "capital": "Nouakchott", "languages": ["Arabic"], "demonym": "Mauritanian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Israel", "code": "IL", "capital": "Jerusalem", "languages": ["Hebrew", "Arabic"], "demonym": "Israeli", "region": "Asia", "subregion": "Western Asia"}, {"name": "Panama", "code": "PA", "capital": "Panama City", "languages": ["Spanish"], "demonym": "Panamanian", "region": "Americas", "subregion": "Central America"}, {"name": "Spain", "code": "ES", "capital": "Madrid", "languages": ["Spanish"], "demonym": "Spanish", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Costa Rica", "code": "CR", "capital": "San José", "languages": ["Spanish"], "demonym": "Costa Rican", "region": "Americas", "subregion": "Central America"}, {"name": "Northern Mariana Islands", "code": "MP", "capital": "Saipan", "languages": ["English", "Chamorro"], "demonym": "American", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Serbia", "code": "RS", "capital": "Belgrade", "languages": ["rs"], "demonym": "Serbian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Cyprus", "code": "CY", "capital": "Nicosia", "languages": ["Modern Greek (1453-)", "Turkish", "Armenian"], "demonym": "Cypriot", "region": "Europe", "subregion": "Southern Europe"}, {"name": "El Salvador", "code": "SV", "capital": "San Salvador", "languages": ["Spanish"], "demonym": "Salvadoran", "region": "Americas", "subregion": "Central America"}, {"name": "Slovakia", "code": "SK", "capital": "Bratislava", "languages": ["Slovak"], "demonym": "Slovak", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Belize", "code": "BZ", "capital": "Belmopan", "languages": ["English", "Spanish"], "demonym": "Belizean", "region": "Americas", "subregion": "Central America"}, {"name": "Faroe Islands", "code": "FO", "capital": "Tórshavn", "languages": ["Faroese"], "demonym": "Faroese", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Czech Republic", "code": "CZ", "capital": "Prague", "languages": ["Czech", "Slovak"], "demonym": "Czech", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Maldives", "code": "MV", "capital": "Malé", "languages": ["Dhivehi"], "demonym": "Maldivan", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Wales", "code": "GB", "capital": "", "languages": [], "demonym": "", "region": "", "subregion": ""}, {"name": "Georgia", "code": "GE", "capital": "Tbilisi", "languages": ["Georgian"], "demonym": "Georgian", "region": "Asia", "subregion": "Western Asia"}, {"name": "Australia", "code": "AU", "capital": "Canberra", "languages": ["English"], "demonym": "Australian", "region": "Oceania", "subregion": "Australia and New Zealand"}, {"name": "South Georgia", "code": "GS", "capital": "King Edward Point", "languages": ["English"], "demonym": "South Georgia and the South Sandwich Islander", "region": "Americas", "subregion": "South America"}, {"name": "Afghanistan", "code": "AF", "capital": "Kabul", "languages": ["Pushto", "Uzbek", "Turkmen"], "demonym": "Afghan", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Dominican Republic", "code": "DO", "capital": "Santo Domingo", "languages": ["Spanish"], "demonym": "Dominican", "region": "Americas", "subregion": "Caribbean"}, {"name": "Cocos (Keeling) Islands", "code": "CC", "capital": "West Island", "languages": ["English"], "demonym": "Cocos Islander", "region": "Oceania", "subregion": "Australia and New Zealand"}, {"name": "Western Sahara", "code": "EH", "capital": "El Aaiún", "languages": ["Spanish"], "demonym": "Sahrawi", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Fiji", "code": "FJ", "capital": "Suva", "languages": ["English", "Fijian", "Hindi", "Urdu"], "demonym": "Fijian", "region": "Oceania", "subregion": "Melanesia"}, {"name": "Lesotho", "code": "LS", "capital": "Maseru", "languages": ["English", "Southern Sotho"], "demonym": "Mosotho", "region": "Africa", "subregion": "Southern Africa"}, {"name": "Saint Pierre and Miquelon", "code": "PM", "capital": "Saint-Pierre", "languages": ["French"], "demonym": "French", "region": "Americas", "subregion": "Northern America"}, {"name": "Ethiopia", "code": "ET", "capital": "Addis Ababa", "languages": ["Amharic"], "demonym": "Ethiopian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Ireland", "code": "IE", "capital": "Dublin", "languages": ["Irish", "English"], "demonym": "Irish", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Heard Island and McDonald Islands", "code": "HM", "capital": "", "languages": ["English"], "demonym": "Heard and McDonald Islander", "region": "", "subregion": ""}, {"name": "Namibia", "code": "NA", "capital": "Windhoek", "languages": ["English", "Afrikaans"], "demonym": "Namibian", "region": "Africa", "subregion": "Southern Africa"}, {"name": "Zimbabwe", "code": "ZW", "capital": "Harare", "languages": ["English", "Shona", "North Ndebele"], "demonym": "Zimbabwean", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Equatorial Guinea", "code": "GQ", "capital": "Malabo", "languages": ["Spanish", "French"], "demonym": "Equatorial Guinean", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Martinique", "code": "MQ", "capital": "Fort-de-France", "languages": ["French"], "demonym": "French", "region": "Americas", "subregion": "Caribbean"}, {"name": "Oman", "code": "OM", "capital": "Muscat", "languages": ["Arabic"], "demonym": "Omani", "region": "Asia", "subregion": "Western Asia"}, {"name": "Peru", "code": "PE", "capital": "Lima", "languages": ["Spanish"], "demonym": "Peruvian", "region": "Americas", "subregion": "South America"}, {"name": "India", "code": "IN", "capital": "New Delhi", "languages": ["Hindi", "English"], "demonym": "Indian", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Vanuatu", "code": "VU", "capital": "Port Vila", "languages": ["Bislama", "English", "French"], "demonym": "Ni-Vanuatu", "region": "Oceania", "subregion": "Melanesia"}, {"name": "Svalbard and Jan Mayen", "code": "SJ", "capital": "Longyearbyen", "languages": ["Norwegian"], "demonym": "Norwegian", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Saint Vincent and the Grenadines", "code": "VC", "capital": "Kingstown", "languages": ["English"], "demonym": "Saint Vincentian", "region": "Americas", "subregion": "Caribbean"}, {"name": "French Guiana", "code": "GF", "capital": "Cayenne", "languages": ["French"], "demonym": "", "region": "Americas", "subregion": "South America"}, {"name": "Portugal", "code": "PT", "capital": "Lisbon", "languages": ["Portuguese"], "demonym": "Portuguese", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Uganda", "code": "UG", "capital": "Kampala", "languages": ["English", "Swahili (macrolanguage)"], "demonym": "Ugandan", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Suriname", "code": "SR", "capital": "Paramaribo", "languages": ["Dutch"], "demonym": "Surinamer", "region": "Americas", "subregion": "South America"}, {"name": "Somalia", "code": "SO", "capital": "Mogadishu", "languages": ["Somali", "Arabic"], "demonym": "Somali", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "France", "code": "FR", "capital": "Paris", "languages": ["French"], "demonym": "French", "region": "Europe", "subregion": "Western Europe"}, {"name": "Algeria", "code": "DZ", "capital": "Algiers", "languages": ["Arabic"], "demonym": "Algerian", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Democratic Republic of the Congo", "code": "CD", "capital": "Kinshasa", "languages": ["French", "Lingala", "Kongo", "Swahili (macrolanguage)", "Luba-Katanga"], "demonym": "Congolese", "region": "Africa", "subregion": "Middle Africa"}, {"name": "American Samoa", "code": "AS", "capital": "Pago Pago", "languages": ["English", "Samoan"], "demonym": "American Samoan", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Morocco", "code": "MA", "capital": "Rabat", "languages": ["Arabic"], "demonym": "Moroccan", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Turkmenistan", "code": "TM", "capital": "Ashgabat", "languages": ["Turkmen", "Russian"], "demonym": "Turkmen", "region": "Asia", "subregion": "Central Asia"}, {"name": "Uruguay", "code": "UY", "capital": "Montevideo", "languages": ["Spanish"], "demonym": "Uruguayan", "region": "Americas", "subregion": "South America"}, {"name": "Pakistan", "code": "PK", "capital": "Islamabad", "languages": ["English", "Urdu"], "demonym": "Pakistani", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Senegal", "code": "SN", "capital": "Dakar", "languages": ["French"], "demonym": "Senegalese", "region": "Africa", "subregion": "Western Africa"}, {"name": "Sweden", "code": "SE", "capital": "Stockholm", "languages": ["Swedish"], "demonym": "Swedish", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Republic of the Congo", "code": "CG", "capital": "Brazzaville", "languages": ["French", "Lingala"], "demonym": "Congolese", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Denmark", "code": "DK", "capital": "Copenhagen", "languages": ["Danish"], "demonym": "Danish", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Dominica", "code": "DM", "capital": "Roseau", "languages": ["English"], "demonym": "Dominican", "region": "Americas", "subregion": "Caribbean"}, {"name": "Cape Verde", "code": "CV", "capital": "Praia", "languages": ["Portuguese"], "demonym": "Cape Verdian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Bangladesh", "code": "BD", "capital": "Dhaka", "languages": ["Bengali"], "demonym": "Bangladeshi", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Palau", "code": "PW", "capital": "Ngerulmud", "languages": ["English"], "demonym": "Palauan", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Germany", "code": "DE", "capital": "Berlin", "languages": ["German"], "demonym": "German", "region": "Europe", "subregion": "Western Europe"}, {"name": "Nicaragua", "code": "NI", "capital": "Managua", "languages": ["Spanish"], "demonym": "Nicaraguan", "region": "Americas", "subregion": "Central America"}, {"name": "French Southern and Antarctic Lands", "code": "TF", "capital": "Port-aux-Français", "languages": ["French"], "demonym": "French", "region": "", "subregion": ""}, {"name": "Sudan", "code": "SD", "capital": "Khartoum", "languages": ["Arabic", "English"], "demonym": "Sudanese", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Paraguay", "code": "PY", "capital": "Asunción", "languages": ["Spanish", "Guarani"], "demonym": "Paraguayan", "region": "Americas", "subregion": "South America"}, {"name": "Turkey", "code": "TR", "capital": "Ankara", "languages": ["Turkish"], "demonym": "Turkish", "region": "Asia", "subregion": "Western Asia"}, {"name": "Canada", "code": "CA", "capital": "Ottawa", "languages": ["English", "French"], "demonym": "Canadian", "region": "Americas", "subregion": "Northern America"}, {"name": "Sri Lanka", "code": "LK", "capital": "Colombo", "languages": ["Sinhala", "Tamil"], "demonym": "Sri Lankan", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Kenya", "code": "KE", "capital": "Nairobi", "languages": ["English", "Swahili (macrolanguage)"], "demonym": "Kenyan", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Niger", "code": "NE", "capital": "Niamey", "languages": ["French"], "demonym": "Nigerien", "region": "Africa", "subregion": "Western Africa"}, {"name": "Bolivia", "code": "BO", "capital": "Sucre", "languages": ["Spanish", "Aymara", "Quechua"], "demonym": "Bolivian", "region": "Americas", "subregion": "South America"}, {"name": "Singapore", "code": "SG", "capital": "Singapore", "languages": ["English", "Malay (macrolanguage)", "Tamil", "Chinese"], "demonym": "Singaporean", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "United States", "code": "US", "capital": "Washington D.C.", "languages": ["English"], "demonym": "American", "region": "Americas", "subregion": "Northern America"}, {"name": "Netherlands", "code": "NL", "capital": "Amsterdam", "languages": ["Dutch"], "demonym": "Dutch", "region": "Europe", "subregion": "Western Europe"}, {"name": "Guernsey", "code": "GG", "capital": "St. Peter Port", "languages": ["English", "French"], "demonym": "Channel Islander", "region": "Europe", "subregion": "Northern Europe"}, {"name": "French Polynesia", "code": "PF", "capital": "Papeetē", "languages": ["French"], "demonym": "French Polynesian", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Jersey", "code": "JE", "capital": "Saint Helier", "languages": ["English", "French"], "demonym": "Channel Islander", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Chile", "code": "CL", "capital": "Santiago", "languages": ["Spanish"], "demonym": "Chilean", "region": "Americas", "subregion": "South America"}, {"name": "Liberia", "code": "LR", "capital": "Monrovia", "languages": ["English"], "demonym": "Liberian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Saint Kitts and Nevis", "code": "KN", "capital": "Basseterre", "languages": ["English"], "demonym": "Kittian and Nevisian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Barbados", "code": "BB", "capital": "Bridgetown", "languages": ["English"], "demonym": "Barbadian", "region": "Americas", "subregion": "Caribbean"}, {"name": "São Tomé and Príncipe", "code": "ST", "capital": "São Tomé", "languages": ["Portuguese"], "demonym": "Sao Tomean", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Iran", "code": "IR", "capital": "Tehran", "languages": ["Persian"], "demonym": "Iranian", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Kiribati", "code": "KI", "capital": "South Tarawa", "languages": ["English"], "demonym": "I-Kiribati", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Belgium", "code": "BE", "capital": "Brussels", "languages": ["Dutch", "French", "German"], "demonym": "Belgian", "region": "Europe", "subregion": "Western Europe"}, {"name": "Estonia", "code": "EE", "capital": "Tallinn", "languages": ["Estonian"], "demonym": "Estonian", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Haiti", "code": "HT", "capital": "Port-au-Prince", "languages": ["French", "Haitian"], "demonym": "Haitian", "region": "Americas", "subregion": "Caribbean"}, {"name": "The Bahamas", "code": "BS", "capital": "Nassau", "languages": ["English"], "demonym": "Bahamian", "region": "Americas", "subregion": "Caribbean"}, {"name": "San Marino", "code": "SM", "capital": "City of San Marino", "languages": ["Italian"], "demonym": "Sammarinese", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Botswana", "code": "BW", "capital": "Gaborone", "languages": ["English", "Tswana"], "demonym": "Motswana", "region": "Africa", "subregion": "Southern Africa"}, {"name": "Slovenia", "code": "SI", "capital": "Ljubljana", "languages": ["Slovenian"], "demonym": "Slovene", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Ghana", "code": "GH", "capital": "Accra", "languages": ["English"], "demonym": "Ghanaian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Zambia", "code": "ZM", "capital": "Lusaka", "languages": ["English"], "demonym": "Zambian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Mozambique", "code": "MZ", "capital": "Maputo", "languages": ["Portuguese"], "demonym": "Mozambican", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Antigua and Barbuda", "code": "AG", "capital": "Saint John's", "languages": ["English"], "demonym": "Antiguan,Barbudan", "region": "Americas", "subregion": "Caribbean"}, {"name": "Tanzania", "code": "TZ", "capital": "Dodoma", "languages": ["Swahili (macrolanguage)", "English"], "demonym": "Tanzanian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Nigeria", "code": "NG", "capital": "Abuja", "languages": ["English"], "demonym": "Nigerian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Tonga", "code": "TO", "capital": "Nuku'alofa", "languages": ["English", "Tonga (Tonga Islands)"], "demonym": "Tongan", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Bosnia and Herzegovina", "code": "BA", "capital": "Sarajevo", "languages": ["Bosnian", "Croatian", "Serbian"], "demonym": "Bosnian,Herzegovinian", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Grenada", "code": "GD", "capital": "St. George's", "languages": ["English"], "demonym": "Grenadian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Solomon Islands", "code": "SB", "capital": "Honiara", "languages": ["English"], "demonym": "Solomon Islander", "region": "Oceania", "subregion": "Melanesia"}, {"name": "Federated States of Micronesia", "code": "FM", "capital": "Palikir", "languages": ["English"], "demonym": "Micronesian", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Libya", "code": "LY", "capital": "Tripoli", "languages": ["Arabic"], "demonym": "Libyan", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Trinidad and Tobago", "code": "TT", "capital": "Port of Spain", "languages": ["English"], "demonym": "Trinidadian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Brunei", "code": "BN", "capital": "Bandar Seri Begawan", "languages": ["Malay (macrolanguage)"], "demonym": "Bruneian", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "North Korea", "code": "KP", "capital": "Pyongyang", "languages": ["Korean"], "demonym": "North Korean", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "Madagascar", "code": "MG", "capital": "Antananarivo", "languages": ["French", "Malagasy"], "demonym": "Malagasy", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Cayman Islands", "code": "KY", "capital": "George Town", "languages": ["English"], "demonym": "Caymanian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Luxembourg", "code": "LU", "capital": "Luxembourg", "languages": ["French", "German", "Luxembourgish"], "demonym": "Luxembourger", "region": "Europe", "subregion": "Western Europe"}, {"name": "Saint Lucia", "code": "LC", "capital": "Castries", "languages": ["English"], "demonym": "Saint Lucian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Guinea-Bissau", "code": "GW", "capital": "Bissau", "languages": ["Portuguese"], "demonym": "Guinea-Bissauan", "region": "Africa", "subregion": "Western Africa"}, {"name": "British Indian Ocean Territory", "code": "IO", "capital": "Diego Garcia", "languages": ["English"], "demonym": "Indian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Tajikistan", "code": "TJ", "capital": "Dushanbe", "languages": ["Tajik", "Russian"], "demonym": "Tadzhik", "region": "Asia", "subregion": "Central Asia"}, {"name": "Isle of Man", "code": "IM", "capital": "Douglas", "languages": ["English", "Manx"], "demonym": "Manx", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Macau", "code": "MO", "capital": "", "languages": ["Chinese", "Portuguese"], "demonym": "Chinese", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "East Timor", "code": "TL", "capital": "Dili", "languages": ["Portuguese"], "demonym": "East Timorese", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Marshall Islands", "code": "MH", "capital": "Majuro", "languages": ["English", "Marshallese"], "demonym": "Marshallese", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Swaziland", "code": "SZ", "capital": "Lobamba", "languages": ["English", "Swati"], "demonym": "Swazi", "region": "Africa", "subregion": "Southern Africa"}, {"name": "Saint Helena", "code": "SH", "capital": "Jamestown", "languages": ["English"], "demonym": "Saint Helenian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Bermuda", "code": "BM", "capital": "Hamilton", "languages": ["English"], "demonym": "Bermudian", "region": "Americas", "subregion": "Northern America"}, {"name": "Jamaica", "code": "JM", "capital": "Kingston", "languages": ["English"], "demonym": "Jamaican", "region": "Americas", "subregion": "Caribbean"}, {"name": "China", "code": "CN", "capital": "Beijing", "languages": ["Chinese"], "demonym": "Chinese", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "Tokelau", "code": "TK", "capital": "Fakaofo", "languages": ["English"], "demonym": "Tokelauan", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Lebanon", "code": "LB", "capital": "Beirut", "languages": ["Arabic", "French"], "demonym": "Lebanese", "region": "Asia", "subregion": "Western Asia"}, {"name": "Mexico", "code": "MX", "capital": "Mexico City", "languages": ["Spanish"], "demonym": "Mexican", "region": "Americas", "subregion": "Central America"}, {"name": "Italy", "code": "IT", "capital": "Rome", "languages": ["Italian"], "demonym": "Italian", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Angola", "code": "AO", "capital": "Luanda", "languages": ["Portuguese"], "demonym": "Angolan", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Bahrain", "code": "BH", "capital": "Manama", "languages": ["Arabic"], "demonym": "Bahraini", "region": "Asia", "subregion": "Western Asia"}, {"name": "Mongolia", "code": "MN", "capital": "Ulan Bator", "languages": ["Mongolian"], "demonym": "Mongolian", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "Mauritius", "code": "MU", "capital": "Port Louis", "languages": ["English"], "demonym": "Mauritian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Mali", "code": "ML", "capital": "Bamako", "languages": ["French"], "demonym": "Malian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Iraq", "code": "IQ", "capital": "Baghdad", "languages": ["Arabic", "Kurdish"], "demonym": "Iraqi", "region": "Asia", "subregion": "Western Asia"}, {"name": "Nepal", "code": "NP", "capital": "Kathmandu", "languages": ["Nepali (macrolanguage)"], "demonym": "Nepalese", "region": "Asia", "subregion": "Southern Asia"}, {"name": "Cuba", "code": "CU", "capital": "Havana", "languages": ["Spanish"], "demonym": "Cuban", "region": "Americas", "subregion": "Caribbean"}, {"name": "Pitcairn Islands", "code": "PN", "capital": "Adamstown", "languages": ["English"], "demonym": "Pitcairn Islander", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Indonesia", "code": "ID", "capital": "Jakarta", "languages": ["Indonesian"], "demonym": "Indonesian", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Thailand", "code": "TH", "capital": "Bangkok", "languages": ["Thai"], "demonym": "Thai", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Hungary", "code": "HU", "capital": "Budapest", "languages": ["Hungarian"], "demonym": "Hungarian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Falkland Islands", "code": "FK", "capital": "Stanley", "languages": ["English"], "demonym": "Falkland Islander", "region": "Americas", "subregion": "South America"}, {"name": "Monaco", "code": "MC", "capital": "Monaco", "languages": ["French"], "demonym": "Monegasque", "region": "Europe", "subregion": "Western Europe"}, {"name": "Ecuador", "code": "EC", "capital": "Quito", "languages": ["Spanish"], "demonym": "Ecuadorean", "region": "Americas", "subregion": "South America"}, {"name": "Ivory Coast", "code": "CI", "capital": "Yamoussoukro", "languages": ["French"], "demonym": "Ivorian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Comoros", "code": "KM", "capital": "Moroni", "languages": ["Arabic", "French"], "demonym": "Comoran", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Greece", "code": "GR", "capital": "Athens", "languages": ["Modern Greek (1453-)"], "demonym": "Greek", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Poland", "code": "PL", "capital": "Warsaw", "languages": ["Polish"], "demonym": "Polish", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Armenia", "code": "AM", "capital": "Yerevan", "languages": ["Armenian", "Russian"], "demonym": "Armenian", "region": "Asia", "subregion": "Western Asia"}, {"name": "Venezuela", "code": "VE", "capital": "Caracas", "languages": ["Spanish"], "demonym": "Venezuelan", "region": "Americas", "subregion": "South America"}, {"name": "South Sudan", "code": "SS", "capital": "Juba", "languages": ["English"], "demonym": "South Sudanese", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Croatia", "code": "HR", "capital": "Zagreb", "languages": ["Croatian"], "demonym": "Croatian", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Greenland", "code": "GL", "capital": "Nuuk", "languages": ["Kalaallisut"], "demonym": "Greenlandic", "region": "Americas", "subregion": "Northern America"}, {"name": "Burkina Faso", "code": "BF", "capital": "Ouagadougou", "languages": ["French", "Fulah"], "demonym": "Burkinabe", "region": "Africa", "subregion": "Western Africa"}, {"name": "Egypt", "code": "EG", "capital": "Cairo", "languages": ["Arabic"], "demonym": "Egyptian", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Samoa", "code": "WS", "capital": "Apia", "languages": ["Samoan", "English"], "demonym": "Samoan", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Guyana", "code": "GY", "capital": "Georgetown", "languages": ["English"], "demonym": "Guyanese", "region": "Americas", "subregion": "South America"}, {"name": "Albania", "code": "AL", "capital": "Tirana", "languages": ["Albanian"], "demonym": "Albanian", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Austria", "code": "AT", "capital": "Vienna", "languages": ["German"], "demonym": "Austrian", "region": "Europe", "subregion": "Western Europe"}, {"name": "Liechtenstein", "code": "LI", "capital": "Vaduz", "languages": ["German"], "demonym": "Liechtensteiner", "region": "Europe", "subregion": "Western Europe"}, {"name": "Philippines", "code": "PH", "capital": "Manila", "languages": ["English"], "demonym": "Filipino", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Rwanda", "code": "RW", "capital": "Kigali", "languages": ["Kinyarwanda", "English", "French"], "demonym": "Rwandan", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Uzbekistan", "code": "UZ", "capital": "Tashkent", "languages": ["Uzbek", "Russian"], "demonym": "Uzbekistani", "region": "Asia", "subregion": "Central Asia"}, {"name": "Ukraine", "code": "UA", "capital": "Kiev", "languages": ["Ukrainian"], "demonym": "Ukrainian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Guatemala", "code": "GT", "capital": "Guatemala City", "languages": ["Spanish"], "demonym": "Guatemalan", "region": "Americas", "subregion": "Central America"}, {"name": "Argentina", "code": "AR", "capital": "Buenos Aires", "languages": ["Spanish", "Guarani"], "demonym": "Argentinean", "region": "Americas", "subregion": "South America"}, {"name": "Guinea", "code": "GN", "capital": "Conakry", "languages": ["French", "Fulah"], "demonym": "Guinean", "region": "Africa", "subregion": "Western Africa"}, {"name": "Réunion", "code": "RE", "capital": "Saint-Denis", "languages": ["French"], "demonym": "French", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "South Korea", "code": "KR", "capital": "Seoul", "languages": ["Korean"], "demonym": "South Korean", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "Belarus", "code": "BY", "capital": "Minsk", "languages": ["Belarusian", "Russian"], "demonym": "Belarusian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Brazil", "code": "BR", "capital": "Brasília", "languages": ["Portuguese"], "demonym": "Brazilian", "region": "Americas", "subregion": "South America"}, {"name": "Norway", "code": "NO", "capital": "Oslo", "languages": ["Norwegian", "Norwegian Bokmål", "Norwegian Nynorsk"], "demonym": "Norwegian", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Malta", "code": "MT", "capital": "Valletta", "languages": ["Maltese", "English"], "demonym": "Maltese", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Chad", "code": "TD", "capital": "N'Djamena", "languages": ["French", "Arabic"], "demonym": "Chadian", "region": "Africa", "subregion": "Middle Africa"}, {"name": "New Caledonia", "code": "NC", "capital": "Nouméa", "languages": ["French"], "demonym": "New Caledonian", "region": "Oceania", "subregion": "Melanesia"}, {"name": "Puerto Rico", "code": "PR", "capital": "San Juan", "languages": ["Spanish", "English"], "demonym": "Puerto Rican", "region": "Americas", "subregion": "Caribbean"}, {"name": "Romania", "code": "RO", "capital": "Bucharest", "languages": ["Romanian"], "demonym": "Romanian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Taiwan", "code": "TW", "capital": "Taipei", "languages": ["Chinese"], "demonym": "Taiwanese", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "Eritrea", "code": "ER", "capital": "Asmara", "languages": ["Tigrinya", "Arabic", "English"], "demonym": "Eritrean", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Guadeloupe", "code": "GP", "capital": "Basse-Terre", "languages": ["French"], "demonym": "Guadeloupian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Hong Kong", "code": "HK", "capital": "City of Victoria", "languages": ["English", "Chinese"], "demonym": "Chinese", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "Cameroon", "code": "CM", "capital": "Yaoundé", "languages": ["English", "French"], "demonym": "Cameroonian", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Anguilla", "code": "AI", "capital": "The Valley", "languages": ["English"], "demonym": "Anguillian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Finland", "code": "FI", "capital": "Helsinki", "languages": ["Finnish", "Swedish"], "demonym": "Finnish", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Iceland", "code": "IS", "capital": "Reykjavik", "languages": ["Icelandic"], "demonym": "Icelander", "region": "Europe", "subregion": "Northern Europe"}, {"name": "New Zealand", "code": "NZ", "capital": "Wellington", "languages": ["English", "Maori"], "demonym": "New Zealander", "region": "Oceania", "subregion": "Australia and New Zealand"}, {"name": "Kazakhstan", "code": "KZ", "capital": "Astana", "languages": ["Kazakh", "Russian"], "demonym": "Kazakhstani", "region": "Asia", "subregion": "Central Asia"}, {"name": "Saudi Arabia", "code": "SA", "capital": "Riyadh", "languages": ["Arabic"], "demonym": "Saudi Arabian", "region": "Asia", "subregion": "Western Asia"}, {"name": "Gabon", "code": "GA", "capital": "Libreville", "languages": ["French"], "demonym": "Gabonese", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Kyrgyzstan", "code": "KG", "capital": "Bishkek", "languages": ["Kirghiz", "Russian"], "demonym": "Kirghiz", "region": "Asia", "subregion": "Central Asia"}, {"name": "Seychelles", "code": "SC", "capital": "Victoria", "languages": ["French", "English"], "demonym": "Seychellois", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Aruba", "code": "AW", "capital": "Oranjestad", "languages": ["Dutch", "Panjabi"], "demonym": "Aruban", "region": "Americas", "subregion": "Caribbean"}, {"name": "Moldova", "code": "MD", "capital": "Chișinău", "languages": ["Romanian"], "demonym": "Moldovan", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Papua New Guinea", "code": "PG", "capital": "Port Moresby", "languages": ["English"], "demonym": "Papua New Guinean", "region": "Oceania", "subregion": "Melanesia"}, {"name": "Syria", "code": "SY", "capital": "Damascus", "languages": ["Arabic"], "demonym": "Syrian", "region": "Asia", "subregion": "Western Asia"}, {"name": "Sierra Leone", "code": "SL", "capital": "Freetown", "languages": ["English"], "demonym": "Sierra Leonean", "region": "Africa", "subregion": "Western Africa"}, {"name": "Vietnam", "code": "VN", "capital": "Hanoi", "languages": ["Vietnamese"], "demonym": "Vietnamese", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "The Gambia", "code": "GM", "capital": "Banjul", "languages": ["English"], "demonym": "Gambian", "region": "Africa", "subregion": "Western Africa"}, {"name": "Gibraltar", "code": "GI", "capital": "Gibraltar", "languages": ["English"], "demonym": "Gibraltar", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Niue", "code": "NU", "capital": "Alofi", "languages": ["English"], "demonym": "Niuean", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Central African Republic", "code": "CF", "capital": "Bangui", "languages": ["French", "Sango"], "demonym": "Central African", "region": "Africa", "subregion": "Middle Africa"}, {"name": "Tunisia", "code": "TN", "capital": "Tunis", "languages": ["Arabic"], "demonym": "Tunisian", "region": "Africa", "subregion": "Northern Africa"}, {"name": "Azerbaijan", "code": "AZ", "capital": "Baku", "languages": ["Azerbaijani", "Armenian"], "demonym": "Azerbaijani", "region": "Asia", "subregion": "Western Asia"}, {"name": "Wallis and Futuna", "code": "WF", "capital": "Mata-Utu", "languages": ["French"], "demonym": "Wallis and Futuna Islander", "region": "Oceania", "subregion": "Polynesia"}, {"name": "Russia", "code": "RU", "capital": "Moscow", "languages": ["Russian"], "demonym": "Russian", "region": "Europe", "subregion": "Eastern Europe"}, {"name": "Burundi", "code": "BI", "capital": "Bujumbura", "languages": ["French", "Rundi"], "demonym": "Burundian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Yemen", "code": "YE", "capital": "Sana'a", "languages": ["Arabic"], "demonym": "Yemeni", "region": "Asia", "subregion": "Western Asia"}, {"name": "Nauru", "code": "NR", "capital": "Yaren", "languages": ["English", "Nauru"], "demonym": "Nauruan", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Norfolk Island", "code": "NF", "capital": "Kingston", "languages": ["English"], "demonym": "Norfolk Islander", "region": "Oceania", "subregion": "Australia and New Zealand"}, {"name": "Guam", "code": "GU", "capital": "Hagåtña", "languages": ["English", "Chamorro", "Spanish"], "demonym": "Guamanian", "region": "Oceania", "subregion": "Micronesia"}, {"name": "Latvia", "code": "LV", "capital": "Riga", "languages": ["Latvian"], "demonym": "Latvian", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Togo", "code": "TG", "capital": "Lomé", "languages": ["French"], "demonym": "Togolese", "region": "Africa", "subregion": "Western Africa"}, {"name": "Benin", "code": "BJ", "capital": "Porto-Novo", "languages": ["French"], "demonym": "Beninese", "region": "Africa", "subregion": "Western Africa"}, {"name": "South Africa", "code": "ZA", "capital": "Pretoria", "languages": ["Afrikaans", "English", "South Ndebele", "Southern Sotho", "Swati", "Tswana", "Tsonga", "Venda", "Xhosa", "Zulu"], "demonym": "South African", "region": "Africa", "subregion": "Southern Africa"}, {"name": "Qatar", "code": "QA", "capital": "Doha", "languages": ["Arabic"], "demonym": "Qatari", "region": "Asia", "subregion": "Western Asia"}, {"name": "Cambodia", "code": "KH", "capital": "Phnom Penh", "languages": ["Central Khmer"], "demonym": "Cambodian", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Lithuania", "code": "LT", "capital": "Vilnius", "languages": ["Lithuanian"], "demonym": "Lithuanian", "region": "Europe", "subregion": "Northern Europe"}, {"name": "Honduras", "code": "HN", "capital": "Tegucigalpa", "languages": ["Spanish"], "demonym": "Honduran", "region": "Americas", "subregion": "Central America"}, {"name": "Montserrat", "code": "MS", "capital": "Plymouth", "languages": ["English"], "demonym": "Montserratian", "region": "Americas", "subregion": "Caribbean"}, {"name": "Switzerland", "code": "CH", "capital": "Bern", "languages": ["German", "French", "Italian"], "demonym": "Swiss", "region": "Europe", "subregion": "Western Europe"}, {"name": "Malaysia", "code": "MY", "capital": "Kuala Lumpur", "languages": [], "demonym": "Malaysian", "region": "Asia", "subregion": "South-Eastern Asia"}, {"name": "Malawi", "code": "MW", "capital": "Lilongwe", "languages": ["English", "Nyanja"], "demonym": "Malawian", "region": "Africa", "subregion": "Eastern Africa"}, {"name": "Jordan", "code": "JO", "capital": "Amman", "languages": ["Arabic"], "demonym": "Jordanian", "region": "Asia", "subregion": "Western Asia"}, {"name": "Kuwait", "code": "KW", "capital": "Kuwait City", "languages": ["Arabic"], "demonym": "Kuwaiti", "region": "Asia", "subregion": "Western Asia"}, {"name": "Republic of Macedonia", "code": "MK", "capital": "Skopje", "languages": ["Macedonian"], "demonym": "Macedonian", "region": "Europe", "subregion": "Southern Europe"}, {"name": "Christmas Island", "code": "CX", "capital": "Flying Fish Cove", "languages": ["English"], "demonym": "Christmas Island", "region": "Oceania", "subregion": "Australia and New Zealand"}, {"name": "Japan", "code": "JP", "capital": "Tokyo", "languages": ["Japanese"], "demonym": "Japanese", "region": "Asia", "subregion": "Eastern Asia"}, {"name": "United Arab Emirates", "code": "AE", "capital": "Abu Dhabi", "languages": ["Arabic"], "demonym": "Emirati", "region": "Asia", "subregion": "Western Asia"}, {"name": "Mayotte", "code": "YT", "capital": "Mamoudzou", "languages": ["French"], "demonym": "French", "region": "Africa", "subregion": "Eastern Africa"}]</script>
<script>
(() => {
  "use strict";

  const GOV = {"United States": "Democracy", "Canada": "Constitutional Monarchy", "United Kingdom": "Constitutional Monarchy", "Saudi Arabia": "Absolute Monarchy", "Japan": "Constitutional Monarchy", "Russia": "Federation", "Kenya": "Republic", "Germany": "Republic", "Mexico": "Republic", "Brazil": "Federation", "Australia": "Constitutional Monarchy", "Spain": "Constitutional Monarchy", "Sweden": "Constitutional Monarchy", "Norway": "Constitutional Monarchy", "Denmark": "Constitutional Monarchy", "Netherlands": "Constitutional Monarchy", "Belgium": "Constitutional Monarchy", "Thailand": "Constitutional Monarchy", "China": "Republic", "India": "Republic", "Egypt": "Republic", "South Africa": "Republic", "Turkey": "Republic", "Nigeria": "Republic", "Switzerland": "Democracy", "Israel": "Democracy", "Vietnam": "Republic", "Singapore": "Republic", "Ukraine": "Republic", "Chile": "Republic"};
  const ECON = {"Japan": "Cars and electronics", "Brazil": "Coffee and soybeans", "Saudi Arabia": "Oil", "Kenya": "Tea and coffee farming", "Canada": "Timber and oil", "India": "IT services and textiles", "Egypt": "Tourism and farming", "Germany": "Cars and machinery", "Mexico": "Oil and cars", "Australia": "Minerals and wool", "China": "Manufacturing and electronics", "South Africa": "Gold and diamonds"};

  const $ = (s) => document.querySelector(s);
  const toastEl = $("#toast");
  let toastTimer = null;
  function toast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(()=>toastEl.classList.remove("show"), 1300);
  }

  // Parse embedded dataset (offline, no loading)
  const COUNTRIES = JSON.parse(document.getElementById("countriesData").textContent);
  $("#countryCount").textContent = String(COUNTRIES.length);

  function shuffle(a){
    const arr = a.slice();
    for(let i=arr.length-1;i>0;i--) {
      const j = (Math.random()*(i+1))|0;
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function flagEmoji(code){
    if(!code || code.length!==2) return "🏳️";
    const A = 0x1F1E6;
    const c0 = code.toUpperCase().charCodeAt(0) - 65;
    const c1 = code.toUpperCase().charCodeAt(1) - 65;
    if(c0<0||c0>25||c1<0||c1>25) return "🏳️";
    return String.fromCodePoint(A+c0, A+c1);
  }

  function canon(s){
    return String(s||"")
      .toLowerCase()
      .replace(/\(.*?\)/g,"")
      .replace(/[’']/g,"'")
      .replace(/[.,]/g,"")
      .replace(/\s+/g," ")
      .trim();
  }

  function uniqueOptions(correct, pool, n){
    const out=[];
    const seen=new Set([canon(correct)]);
    for(const p of shuffle(pool)) {
      const k=canon(p);
      if(!k || seen.has(k)) continue;
      seen.add(k);
      out.push(p);
      if(out.length===n) break;
    }
    return out;
  }

  function sameRegionPool(c){
    const sub = c.subregion || "";
    const reg = c.region || "";
    let pool = COUNTRIES.filter(x => x.name !== c.name && x.subregion && x.subregion === sub);
    if(pool.length < 12) pool = COUNTRIES.filter(x => x.name !== c.name && x.region === reg);
    if(pool.length < 12) pool = COUNTRIES.filter(x => x.name !== c.name);
    return pool;
  }

  function langAnswer(c){
    const langs = Array.isArray(c.languages) ? c.languages.filter(Boolean) : [];
    if(!langs.length) return "English";
    if(langs.length === 1) return langs[0];
    return langs.slice().sort((a,b)=>a.localeCompare(b)).join(", ");
  }

  const TOPIC_LABEL = {
    FLAG:"Flag",
    CAPITAL:"Capital",
    LANGUAGE:"Language",
    NATIONALITY:"Nationality",
    GOV:"Government",
    ECON:"Economy"
  };

  // ----------------- State -----------------
  const state = {
    mode: "menu", // study | exam | time | menu
    examTotal: 30,
    examIndex: 0,
    timeLeft: 60,
    timerId: null,

    lifelines: 3,
    locked: false,
    current: null,

    xp: 0,
    streak: 0,
    correct: 0,
    wrong: 0,
    misses: []
  };

  // ----------------- UI elements -----------------
  const modeSelect = $("#modeSelect");
  const examCount = $("#examCount");

  const btnStart = $("#btnStart");
  const btnNext = $("#btnNext");
  const btnMenu = $("#btnMenu");
  const btnRestart = $("#btnRestart");
  const btnLifeline = $("#btnLifeline");

  const answers = $("#answers");
  const qTitle = $("#qTitle");
  const qSub = $("#qSub");
  const metaLine = $("#metaLine");
  const topicTag = $("#topicTag");
  const timerEl = $("#timer");
  const results = $("#results");
  const missList = $("#missList");

  const modeLabel = $("#modeLabel");
  const xpEl = $("#xp");
  const streakEl = $("#streak");
  const accEl = $("#acc");
  const lifelinesEl = $("#lifelines");
  const examProgWrap = $("#examProgWrap");
  const examProg = $("#examProg");
  const finalScore = $("#finalScore");
  const finalMeta = $("#finalMeta");

  // ----------------- Event delegation (click safe) -----------------
  answers.addEventListener("click", (e) => {
    const b = e.target.closest("button.ans");
    if(!b) return;
    const idx = Number(b.dataset.idx);
    if(Number.isNaN(idx)) return;
    choose(idx);
  }, {passive:true});

  window.addEventListener("keydown", (e) => {
    const k = e.key;
    if(k >= "1" && k <= "4") {
      const idx = Number(k)-1;
      const b = answers.querySelector(`button.ans[data-idx="${idx}"]`);
      if(b && !b.disabled) b.click();
    }
    if(k === "Enter") btnNext.click();
  });

  btnMenu.addEventListener("click", () => {
    stopTimer();
    setMode("menu");
    toast("Menu");
  });

  btnRestart.addEventListener("click", () => {
    restartRun();
    if(state.mode !== "menu") nextQuestion(true);
    toast("Restarted");
  });

  btnStart.addEventListener("click", () => {
    startRun(modeSelect.value, Number(examCount.value)||30);
  });

  btnNext.addEventListener("click", () => {
    if(state.mode === "exam" && !state.locked) {
      toast("Pick an answer first");
      return;
    }
    nextQuestion(false);
  });

  btnLifeline.addEventListener("click", () => {
    useLifeline();
  });

  function setMode(m){
    state.mode = m;
    modeLabel.textContent = m === "menu" ? "Menu" : (m === "study" ? "Study" : (m === "exam" ? "Exam" : "Time Attack"));
    timerEl.style.display = (m === "time") ? "block" : "none";
    examProgWrap.style.display = (m === "exam") ? "inline-flex" : "none";
  }

  function updateHUD(){
    xpEl.textContent = String(state.xp);
    streakEl.textContent = String(state.streak);
    lifelinesEl.textContent = String(state.lifelines);
    const total = state.correct + state.wrong;
    accEl.textContent = total ? (Math.round((state.correct/total)*100) + "%") : "—";
    if(state.mode === "exam") {
      examProg.textContent = `${Math.min(state.examIndex+1, state.examTotal)}/${state.examTotal}`;
    }
    if(state.mode === "time") {
      timerEl.textContent = String(state.timeLeft);
      timerEl.style.color = (state.timeLeft <= 10) ? "var(--bad)" : "var(--warn)";
    }
  }

  function restartRun(){
    stopTimer();
    state.lifelines = 3;
    state.locked = false;
    state.current = null;

    state.xp = 0;
    state.streak = 0;
    state.correct = 0;
    state.wrong = 0;
    state.misses = [];
    state.examIndex = 0;

    results.style.display = "none";
    answers.innerHTML = "";
    topicTag.textContent = "Ready";
    metaLine.textContent = "";
    qTitle.textContent = "Choose a mode and press Start.";
    qSub.textContent = "";
    updateHUD();
  }

  function startRun(mode, examN){
    restartRun();
    setMode(mode);
    state.examTotal = examN || 30;

    if(mode === "time") {
      state.timeLeft = 60;
      startTimer();
    }

    nextQuestion(true);
    toast("Started");
  }

  function startTimer(){
    stopTimer();
    timerEl.style.display = "block";
    state.timerId = setInterval(() => {
      state.timeLeft -= 1;
      if(state.timeLeft < 0) state.timeLeft = 0;
      updateHUD();
      if(state.timeLeft <= 10 && state.timeLeft > 0) {
        // small pressure pulse
        qTitle.style.transform = "scale(1.01)";
        setTimeout(()=>qTitle.style.transform="scale(1)", 80);
      }
      if(state.timeLeft === 0) {
        stopTimer();
        showTimeResults();
      }
    }, 1000);
  }

  function stopTimer(){
    if(state.timerId) {
      clearInterval(state.timerId);
      state.timerId = null;
    }
  }

  // ----------------- Question builders -----------------
  function pickCountry(filterFn=null){
    for(let t=0;t<60;t++) {
      const c = COUNTRIES[(Math.random()*COUNTRIES.length)|0];
      if(!filterFn || filterFn(c)) return c;
    }
    return COUNTRIES[(Math.random()*COUNTRIES.length)|0];
  }

  function buildFlagQ(){
    const c = pickCountry();
    const pool = sameRegionPool(c).map(x => flagEmoji(x.code));
    const correct = flagEmoji(c.code);
    const opts = shuffle([correct, ...uniqueOptions(correct, pool, 3)]);
    return {
      topic:"FLAG",
      title:`Which is the flag of ${c.name}?`,
      sub:`Region: ${c.region || "—"}`,
      correct,
      options: opts,
      country: c
    };
  }

  function buildCapitalQ(){
    const c = pickCountry(x => x.capital);
    const pool = sameRegionPool(c).map(x => x.capital).filter(Boolean);
    const correct = c.capital;
    const opts = shuffle([correct, ...uniqueOptions(correct, pool, 3)]);
    return {
      topic:"CAPITAL",
      title:`What is the capital of ${c.name}?`,
      sub:`Region: ${c.region || "—"}`,
      correct,
      options: opts,
      country: c
    };
  }

  function buildLanguageQ(){
    const c = pickCountry();
    const correct = langAnswer(c);
    const pool = [];
    // exam-style traps
    if(correct.includes(",")) {
      const parts = correct.split(",").map(s=>s.trim()).filter(Boolean);
      if(parts[0]) pool.push("Only " + parts[0]);
      pool.push("Only English");
      if(parts[parts.length-1]) pool.push("Only " + parts[parts.length-1]);
    } else {
      pool.push("Only " + correct);
      pool.push(correct + " and others");
      pool.push("Only English");
    }
    for(const x of sameRegionPool(c).slice(0,120)) {
      pool.push(langAnswer(x));
    }
    const opts = shuffle([correct, ...uniqueOptions(correct, pool, 3)]);
    return {
      topic:"LANGUAGE",
      title:`What language is spoken in ${c.name}?`,
      sub:`Main / official language(s)`,
      correct,
      options: opts,
      country: c
    };
  }

  function buildNationalityQ(){
    const c = pickCountry(x => x.demonym);
    const correct = c.demonym;
    const pool = [];
    // spelling-like traps
    pool.push(correct + "n");
    pool.push(correct.replace(/ian$/,"ish"));
    pool.push(correct.replace(/ese$/,"ish"));
    pool.push(correct.replace(/ish$/,"ian"));
    pool.push(correct.replace(/an$/,"ian"));
    // other demonyms
    for(const x of sameRegionPool(c).slice(0,160)) {
      if(x.demonym) pool.push(x.demonym);
    }
    const opts = shuffle([correct, ...uniqueOptions(correct, pool, 3)]);
    return {
      topic:"NATIONALITY",
      title:`A person from ${c.name} is:`,
      sub:`Nationality / demonym`,
      correct,
      options: opts,
      country: c
    };
  }

  function buildGovQ(){
    const c = pickCountry(x => GOV[x.name]);
    const correct = GOV[c.name];
    const cats = ["Democracy","Republic","Constitutional Monarchy","Absolute Monarchy","Federation","Dictatorship","Empire","Monarchy"];
    const pool = cats.concat(Object.values(GOV));
    const opts = shuffle([correct, ...uniqueOptions(correct, pool, 3)]);
    return {
      topic:"GOV",
      title:`What type of government does ${c.name} have?`,
      sub:`Simple categories (as in the test)`,
      correct,
      options: opts,
      country: c
    };
  }

  function buildEconQ(){
    const c = pickCountry(x => ECON[x.name]);
    const correct = ECON[c.name];
    const pool = Object.values(ECON).filter(v => canon(v) !== canon(correct)).concat([
      "Tourism",
      "Fishing",
      "Coffee and bananas",
      "Oil and gas",
      "Cars and computers",
      "Diamonds and gold"
    ]);
    const opts = shuffle([correct, ...uniqueOptions(correct, pool, 3)]);
    return {
      topic:"ECON",
      title:`${c.name} is famous for producing / exporting:`,
      sub:`Economy example (association-based)`,
      correct,
      options: opts,
      country: c
    };
  }

  function makeQuestion(){
    // Weighted to typical tests: capitals/language/nationality
    const weighted = [
      "CAPITAL","CAPITAL","CAPITAL",
      "LANGUAGE","LANGUAGE","LANGUAGE",
      "NATIONALITY","NATIONALITY",
      "FLAG","FLAG",
      "GOV",
      "ECON"
    ];
    const pick = weighted[(Math.random()*weighted.length)|0];
    if(pick==="FLAG") return buildFlagQ();
    if(pick==="CAPITAL") return buildCapitalQ();
    if(pick==="LANGUAGE") return buildLanguageQ();
    if(pick==="NATIONALITY") return buildNationalityQ();
    if(pick==="GOV") return buildGovQ();
    return buildEconQ();
  }

  function renderQuestion(q){
    state.current = q;
    state.locked = false;
    topicTag.textContent = `${TOPIC_LABEL[q.topic] || q.topic}`;
    metaLine.textContent = q.sub || "";
    qTitle.textContent = q.title;
    qSub.textContent = `Target: ${flagEmoji(q.country.code)} ${q.country.name}`;

    // render buttons
    answers.innerHTML = "";
    q.options.forEach((opt, i) => {
      const b = document.createElement("button");
      b.className = "ans";
      b.type = "button";
      b.dataset.idx = String(i);
      b.textContent = opt;
      answers.appendChild(b);
    });
  }

  function lockAnswers(chosenText){
    const q = state.current;
    [...answers.querySelectorAll("button.ans")].forEach(b => {
      const t = b.textContent;
      b.disabled = true;
      if(canon(t) === canon(q.correct)) b.classList.add("correct");
      if(canon(t) === canon(chosenText) && canon(t) !== canon(q.correct)) b.classList.add("wrong");
    });
  }

  function choose(idx){
    if(state.locked) return;
    const q = state.current;
    if(!q) return;
    const btn = answers.querySelector(`button.ans[data-idx="${idx}"]`);
    if(!btn || btn.disabled) return;

    const chosen = btn.textContent;
    state.locked = true;

    const ok = canon(chosen) === canon(q.correct);
    lockAnswers(chosen);

    if(ok){
      state.correct += 1;
      state.streak += 1;
      const gain = 10 + Math.min(20, state.streak);
      state.xp += gain;
      toast("Correct +" + gain + " XP");
    } else {
      state.wrong += 1;
      state.streak = 0;
      state.misses.push({
        topic: TOPIC_LABEL[q.topic] || q.topic,
        country: q.country.name,
        qTitle: q.title,
        correct: q.correct,
        chosen
      });
      toast("Wrong");
    }
    updateHUD();
  }

  function useLifeline(){
    if(state.mode === "menu") return;
    if(state.lifelines <= 0) { toast("No lifelines left"); return; }
    if(state.locked) { toast("Use lifeline before answering"); return; }
    const q = state.current;
    if(!q) return;

    const buttons = [...answers.querySelectorAll("button.ans")];
    const wrong = buttons
      .map((b,i)=>({i, t:b.textContent, b}))
      .filter(x => canon(x.t) !== canon(q.correct) && !x.b.disabled);

    if(wrong.length < 2) { toast("Nothing to remove"); return; }
    const remove = shuffle(wrong).slice(0,2);
    remove.forEach(x => {
      x.b.disabled = true;
      x.b.style.opacity = "0.25";
      x.b.style.filter = "grayscale(0.6)";
    });
    state.lifelines -= 1;
    $("#lifelines").textContent = String(state.lifelines);
    toast("Lifeline used");
  }

  function nextQuestion(isFirst){
    // Mode end checks
    if(state.mode === "exam" && !isFirst) {
      if(state.examIndex >= state.examTotal) {
        showExamResults();
        return;
      }
    }
    if(state.mode === "time" && state.timeLeft <= 0) {
      showTimeResults();
      return;
    }

    const q = makeQuestion();
    renderQuestion(q);

    if(state.mode === "exam") {
      if(isFirst) state.examIndex = 0;
      state.examIndex += 1;
      examProg.textContent = `${state.examIndex}/${state.examTotal}`;
    }
    updateHUD();
  }

  function showExamResults(){
    stopTimer();
    results.style.display = "block";
    const score = state.examTotal ? Math.round((state.correct/state.examTotal)*100) : 0;
    finalScore.textContent = `Score: ${score}/100`;
    finalMeta.textContent = `Correct: ${state.correct} · Wrong: ${state.wrong} · XP: ${state.xp} · Lifelines used: ${3 - state.lifelines}`;
    missList.innerHTML = "";
    if(!state.misses.length) {
      missList.innerHTML = `<div class="missItem"><div class="t">Perfect ✅</div><div class="m">No mistakes.</div></div>`;
    } else {
      state.misses.slice(0,60).forEach(m => {
        const div = document.createElement("div");
        div.className = "missItem";
        div.innerHTML = `<div class="t">${m.topic} — ${escapeHtml(m.country)}</div>
          <div class="m"><b>Q:</b> ${escapeHtml(m.qTitle)}<br/>
          <b>You:</b> ${escapeHtml(m.chosen)}<br/>
          <b>Correct:</b> ${escapeHtml(m.correct)}</div>`;
        missList.appendChild(div);
      });
    }
    toast("Exam finished");
  }

  function showTimeResults(){
    results.style.display = "block";
    const total = state.correct + state.wrong;
    const acc = total ? Math.round((state.correct/total)*100) : 0;
    finalScore.textContent = `Time Attack — XP: ${state.xp}`;
    finalMeta.textContent = `Answered: ${total} · Correct: ${state.correct} · Wrong: ${state.wrong} · Accuracy: ${acc}%`;
    missList.innerHTML = "";
    if(state.misses.length) {
      state.misses.slice(0,12).forEach(m => {
        const div = document.createElement("div");
        div.className = "missItem";
        div.innerHTML = `<div class="t">${m.topic} — ${escapeHtml(m.country)}</div>
          <div class="m"><b>Correct:</b> ${escapeHtml(m.correct)} · <b>You:</b> ${escapeHtml(m.chosen)}</div>`;
        missList.appendChild(div);
      });
    } else {
      missList.innerHTML = `<div class="missItem"><div class="t">Nice ✅</div><div class="m">No recorded mistakes.</div></div>`;
    }
    toast("Time Attack ended");
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, c => ({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]));
  }

  function startExam(mode, examN){
    restartRun();
    setMode(mode);
    state.examTotal = examN || 30;

    if(mode === "time") {
      state.timeLeft = 60;
      startTimer();
    }

    results.style.display = "none";
    nextQuestion(true);
  }

  // ----------------- Init -----------------
  function init(){
    setMode("menu");
    updateHUD();
    toast("Ready");
  }

  init();

  // Public start
  window.__GK_START__ = startExam;

})();
</script>
</body>
</html>
